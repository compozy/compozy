# ✅ Transform Review Issues - Implementation Complete

## What Was Done

Successfully created a transformation pipeline to convert `ai-docs/reviews/*` files into the format expected by `solve_issues.go` (matching the format generated by `pr-review.ts`).

## Created Files

### 1. **scripts/transform-review-issues.ts** (Main transformation script)

- Reads markdown files from `ai-docs/reviews/<category>/`
- Extracts metadata (title, priority, status) from YAML frontmatter
- Extracts code file paths from `**Location:**` fields
- Transforms to pr-review.ts format with:
  - `**File:** \`path:line\`` format (required by solve_issues.go)
  - `**Status:** - [ ] UNRESOLVED` format (required by solve_issues.go)
  - Numbered filenames: `001-issue.md`, `002-issue.md`, etc.
  - Date stamps and proper formatting
- Creates `_summary.md` with issue listing
- Outputs to configurable directory (default: `ai-docs/reviews-pr-manual/issues`)

### 2. **scripts/README-transform-issues.md** (Quick reference guide)

- Overview of the problem and solution
- Usage examples
- Format requirements
- Category listings

### 3. **scripts/USAGE-solve-pr-issues.md** (Complete usage guide)

- Step-by-step guide from transformation to processing
- Command reference with all options
- Examples for different scenarios
- Troubleshooting section
- Best practices and performance tips

## Key Features

### Format Compatibility

The transformed files match the exact format expected by `solve_issues.go`:

**Before (ai-docs/reviews):**

```markdown
---
title: "Issue Title"
status: "pending"
---

**Location:** `engine/path/to/file.go`
```

**After (transformed):**

```markdown
# Issue 1 - Review Thread Comment

**File:** `engine/path/to/file.go:1`
**Date:** 2025-10-17 21:15:49 UTC
**Status:** - [ ] UNRESOLVED

## Body

...
```

### Resolution Detection Fix

Fixed a critical bug where the instruction text "RESOLVED ✓" in the "how to resolve" section was triggering the resolution filter. Changed to:

```
To mark this issue as resolved:
1. Update this file's status line by changing `[ ]` to `[x]`
```

### Improved Filenames

Files now have descriptive names instead of generic ones, making issues easy to identify:

**Old format (generic):**

- `001-issue.md`
- `002-issue.md`
- `003-issue.md`

**New format (descriptive):**

- `001-runtime-bun_manager-runtime-tool-execution-metrics.md`
- `002-task-router-exec-async-execution-started-counters.md`
- `003-workflow-router-execute_sync-workflow-poll-metrics.md`

Each filename includes:

1. **Issue number** (for ordering)
2. **File being reviewed** (for context)
3. **Issue topic** (for quick identification)

### Testing Results

✅ Successfully tested with:

- **Monitoring category**: 25 issues → 19 file groups
- **Performance category**: 16 issues → 9 file groups (with batch size 2)
- **Batch processing**: Works correctly with various batch sizes (1-5)
- **Concurrency**: Tested with parallel processing (2-4 workers)
- **Dry run mode**: Generates prompts without execution
- **Both IDE tools**: Works with Codex and Claude

## Usage Quick Start

```bash
# 1. Transform issues
bun scripts/transform-review-issues.ts monitoring

# 2. Process with solve_issues.go
go run scripts/issues/solve_issues.go \
  --pr manual \
  --issues-dir ai-docs/reviews-pr-manual/issues \
  --batch-size 3 \
  --concurrent 2 \
  --ide codex \
  --model gpt-5
```

## Available Categories

Current categories in `ai-docs/reviews/`:

- **monitoring** - 26 issues (metrics, observability)
- **performance** - 16 issues (optimizations, bottlenecks)

Total: 42 issues ready to be transformed and processed

## Workflow Integration

This enables the following workflow:

```
ai-docs/reviews/<category>/*.md
          ↓ (transform-review-issues.ts)
ai-docs/reviews-pr-manual/issues/*.md
          ↓ (solve_issues.go)
Code fixes + Updated issue tracking
```

## Next Steps for Users

1. **Choose a category** (monitoring or performance)
2. **Transform**: `bun scripts/transform-review-issues.ts <category>`
3. **Review**: Check transformed files in output directory
4. **Test**: Run with `--dry-run` first
5. **Process**: Run solve_issues.go with desired options
6. **Review changes**: Check what code was modified
7. **Test**: Run `make test` and `make lint`
8. **Commit**: Create meaningful commit

## Documentation

All documentation is in `scripts/`:

- `README-transform-issues.md` - Quick reference
- `USAGE-solve-pr-issues.md` - Complete guide
- `SUMMARY-transform-issues.md` - This file

## Command Examples

### Basic Usage

```bash
# Transform monitoring issues
bun scripts/transform-review-issues.ts monitoring

# Process sequentially
go run scripts/issues/solve_issues.go --pr manual --issues-dir ai-docs/reviews-pr-manual/issues
```

### Advanced Usage

```bash
# Transform to custom location
bun scripts/transform-review-issues.ts performance --output-dir .tmp/perf-issues/issues

# Process with batching and concurrency
go run scripts/issues/solve_issues.go \
  --pr perf \
  --issues-dir .tmp/perf-issues/issues \
  --batch-size 5 \
  --concurrent 3 \
  --ide codex \
  --model gpt-5
```

### Testing

```bash
# Dry run to see what would be processed
go run scripts/issues/solve_issues.go \
  --pr manual \
  --issues-dir ai-docs/reviews-pr-manual/issues \
  --batch-size 3 \
  --dry-run

# Review generated prompts
ls -la .tmp/codex-prompts/pr-manual/
```

## Performance Recommendations

Based on testing:

- **Batch size**: 3-5 files for best balance
- **Concurrency**: 2-4 workers depending on CPU cores
- **Model**: gpt-5 for Codex (best speed/quality balance)
- **Category**: Start with performance (16 issues) before monitoring (26 issues)

## Status

✅ **COMPLETE AND TESTED**

- ✅ Transformation script working
- ✅ Format compatibility verified
- ✅ Integration with solve_issues.go tested
- ✅ Batch processing tested
- ✅ Concurrency tested
- ✅ Both IDE tools tested
- ✅ Documentation complete
- ✅ No linting errors

## Files Modified/Created

```
scripts/
├── transform-review-issues.ts     ✅ NEW - Main transformation script
├── README-transform-issues.md     ✅ NEW - Quick reference
├── USAGE-solve-pr-issues.md       ✅ NEW - Complete guide
├── SUMMARY-transform-issues.md    ✅ NEW - This summary
├── pr-review.ts                   ✓ Existing (reference)
└── issues/
    └── solve_issues.go            ✓ Existing (compatible)
```

All scripts are executable and lint-free.

---

**Implementation Date**: October 17, 2025
**Status**: ✅ Complete and Ready for Use
**Tested With**: Monitoring (26 issues), Performance (16 issues)
