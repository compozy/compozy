---
title: MCP Proxy Commands
description: Manage Model Context Protocol (MCP) servers and proxy operations with the `compozy mcp-proxy` binary. The MCP proxy server enables HTTP-based access to MCP servers, providing seamless integration between AI agents and external tools.
icon: network
---

## Overview

```bash
compozy mcp-proxy [flags]
```

<FeatureCardList cols={2} size="sm">
  <FeatureCard
    title="HTTP Proxy Server"
    description="Provides HTTP endpoints for MCP server communication with authentication and security controls"
    icon="Globe"
  />
  <FeatureCard
    title="Admin API"
    description="Comprehensive server management interface with authentication and monitoring capabilities"
    icon="Settings"
  />
  <FeatureCard
    title="Network Controls"
    description="Rely on external network controls and reverse proxies"
    icon="Shield"
  />
  <FeatureCard
    title="Production Ready"
    description="Built-in health checks, monitoring, logging, and deployment configurations for production use"
    icon="Rocket"
  />
</FeatureCardList>

## mcp-proxy

Start the MCP proxy server to provide HTTP access to MCP servers.

### Usage

```bash
compozy mcp-proxy [flags]
```

### Description

The MCP proxy server enables HTTP-based access to MCP servers, providing:
- HTTP endpoints for MCP server communication
- Admin API for server management
- Authentication and security controls
- Request logging and monitoring

### Flags

#### MCP Proxy Configuration

<Table>
  <TableHeader>
    <TableRow>
      <TableHead>Flag</TableHead>
      <TableHead>Description</TableHead>
      <TableHead>Default</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    <TableRow>
      <TableCell>`--mcp-host`</TableCell>
      <TableCell>Host interface for MCP proxy server to bind to</TableCell>
      <TableCell>127.0.0.1</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>`--mcp-port`</TableCell>
      <TableCell>Port for MCP proxy server to listen on</TableCell>
      <TableCell>6001</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>`--mcp-base-url`</TableCell>
      <TableCell>Base URL for MCP proxy server (auto-generated if empty)</TableCell>
      <TableCell>-</TableCell>
    </TableRow>
  </TableBody>
</Table>

#### Debugging

<Table>
  <TableHeader>
    <TableRow>
      <TableHead>Flag</TableHead>
      <TableHead>Description</TableHead>
      <TableHead>Default</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    <TableRow>
      <TableCell>`--debug`</TableCell>
      <TableCell>Enable debug mode (sets log level to debug)</TableCell>
      <TableCell>false</TableCell>
    </TableRow>
  </TableBody>
</Table>

### Environment Variables

The MCP proxy can be configured through command-line flags (shown above) or environment variables. Command-line flags take precedence over environment variables.

The MCP proxy respects these environment variables:

```bash
MCP_PROXY_HOST                  # Host to bind the server to
MCP_PROXY_PORT                  # Port to run the MCP proxy server on
MCP_PROXY_BASE_URL              # Base URL for the MCP proxy server
MCP_PROXY_SHUTDOWN_TIMEOUT      # Graceful shutdown timeout
```

## Examples

### Basic Usage

Start the MCP proxy with default settings:

```bash
compozy mcp-proxy
```

This starts the proxy on `0.0.0.0:6001`.

### Custom Port and Host

```bash
compozy mcp-proxy --mcp-host localhost --mcp-port 9000
```

### Debug Mode

```bash
compozy mcp-proxy --debug
```

### Using Environment Variables

```bash
export MCP_PROXY_HOST=localhost
export MCP_PROXY_PORT=9000
export MCP_PROXY_BASE_URL=http://localhost:9000

compozy mcp-proxy
```

## API Endpoints

Once started, the MCP proxy provides these endpoints:

<Tabs items={["Health Checks", "MCP Operations", "Admin API"]}>

<Tab>
**Health monitoring and status endpoints:**

```bash
GET /healthz             # Health check endpoint
```

Example response:
```json
{
  "status": "ok"
}
```
</Tab>

<Tab>
**Core MCP server communication endpoints:**

```bash
POST /mcp/{server_id}    # Proxy requests to MCP servers
GET  /mcp/{server_id}    # Get MCP server information
```

Example usage:
```bash
# Get server information
curl http://localhost:6001/mcp/my-server

# Proxy MCP request
curl -X POST http://localhost:6001/mcp/my-server \
  -H "Content-Type: application/json" \
  -d '{"method": "tools/list", "params": {}}'
```
</Tab>

<Tab>
**Administrative management endpoints (requires admin authentication):**

```bash
GET    /admin/servers       # List configured MCP servers
POST   /admin/servers       # Add new MCP server
PUT    /admin/servers/{id}  # Update MCP server configuration
DELETE /admin/servers/{id}  # Remove MCP server
```

Example server registration:
```bash
curl -X POST http://localhost:6001/admin/servers \
  -H "Authorization: Bearer admin-token" \
  -H "Content-Type: application/json" \
  -d '{
    "id": "my-server",
    "name": "My MCP Server",
    "url": "http://localhost:3000",
    "auth_token": "server-specific-token"
  }'
```
</Tab>

</Tabs>

## Configuration

The MCP proxy can be configured through:

1. **Command-line flags** (highest priority)
2. **Environment variables**
3. **Configuration file** (specified with `--config`)

### Configuration File Example

```yaml
# compozy.yaml
mcp_proxy:
  host: "0.0.0.0"
  port: 6001
  base_url: "http://localhost:6001"
```

## Security Considerations

- Use a reverse proxy or firewall to restrict access to `/admin` endpoints.
- Terminate TLS at your ingress/proxy.
- Apply rate limits and request size limits at your edge.

## Monitoring and Logging

### Health Monitoring

```bash
# Check health status
curl http://localhost:6001/healthz
```

### Log Analysis

```bash
# Follow proxy logs (JSON format)
tail -f /var/log/compozy/mcp-proxy.log | jq '.'

# Filter for errors
grep '"level":"error"' /var/log/compozy/mcp-proxy.log | jq '.'

# Monitor request patterns
grep '"path":' /var/log/compozy/mcp-proxy.log | \
  jq -r '.path' | sort | uniq -c | sort -nr
```

## Production Deployment

### Docker

```dockerfile
FROM ghcr.io/compozy/mcp-proxy:latest
EXPOSE 6001
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD wget --no-verbose --tries=1 --spider http://localhost:6001/healthz || exit 1
CMD ["compozy", "mcp-proxy"]
```

### Docker Compose

```yaml
version: '3.8'
services:
  mcp-proxy:
    image: ghcr.io/compozy/mcp-proxy:latest
    command: ["compozy", "mcp-proxy"]
    ports:
      - "6001:6001"
    environment:
      - MCP_PROXY_HOST=0.0.0.0
      - MCP_PROXY_PORT=6001
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:6001/healthz"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped
```

### Kubernetes

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mcp-proxy
spec:
  replicas: 2
  selector:
    matchLabels:
      app: mcp-proxy
  template:
    metadata:
      labels:
        app: mcp-proxy
    spec:
      containers:
      - name: mcp-proxy
        image: ghcr.io/compozy/mcp-proxy:latest
        command: ["compozy", "mcp-proxy"]
        ports:
        - containerPort: 6001
        env:
        - name: MCP_PROXY_HOST
          value: "0.0.0.0"
        - name: MCP_PROXY_PORT
          value: "6001"
        livenessProbe:
          httpGet:
            path: /healthz
            port: 6001
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /healthz
            port: 6001
          initialDelaySeconds: 5
          periodSeconds: 5
        resources:
          requests:
            memory: "64Mi"
            cpu: "50m"
          limits:
            memory: "256Mi"
            cpu: "200m"
```

## Next Steps

Explore these related topics to get the most out of MCP proxy operations:

### Learn the Fundamentals

<ReferenceCardList>
  <ReferenceCard
    title="MCP Overview"
    description="Understand Model Context Protocol architecture and integration patterns"
    href="/docs/core/mcp/overview"
    icon="BookOpen"
  />
  <ReferenceCard
    title="Agent Tools Integration"
    description="Connect AI agents to external tools through MCP proxy"
    href="/docs/core/agents/tools"
    icon="Link"
  />
  <ReferenceCard
    title="Tool Development"
    description="Build custom MCP servers and tools for specialized operations"
    href="/docs/core/tools/overview"
    icon="Code"
  />
</ReferenceCardList>

### Production & Operations

<ReferenceCardList>
  <ReferenceCard
    title="CLI Reference"
    description="Complete command-line interface reference for all MCP operations"
    href="/docs/core/configuration/cli"
    icon="Terminal"
  />
</ReferenceCardList>
