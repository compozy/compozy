---
title: Execution Commands
description: Start and manage Compozy development and production servers with comprehensive lifecycle management
icon: Play
---

The `compozy dev` and `compozy start` commands provide development and production server capabilities for your Compozy workflows, enabling local development with hot reload and production deployment with optimized settings.

<Callout type="info">
The `dev` command is optimized for development with hot reload and verbose logging, while `start` is optimized for production deployment with performance and security hardening.
</Callout>

## Available Commands

<FeatureCardList cols={2} size="default">
  <FeatureCard
    title="Development Server"
    description="Start local development server with hot reload, file watching, and enhanced debugging capabilities"
    icon="Monitor"
    href="#development-server"
  />
  <FeatureCard
    title="Production Server"
    description="Launch production-ready server with performance optimization, security hardening, and structured logging"
    icon="Server"
    href="#production-server"
  />
  <FeatureCard
    title="MCP Proxy Server"
    description="Run Model Context Protocol proxy server for external tool integration and service orchestration"
    icon="Network"
    href="#mcp-proxy-server"
  />
  <FeatureCard
    title="Health Monitoring"
    description="Built-in health checks, metrics endpoints, and performance profiling for production monitoring"
    icon="Activity"
    href="#health-monitoring"
  />
</FeatureCardList>

## Development Server

### compozy dev

Start the development server with hot reload and enhanced debugging features:

```bash
# Start development server with defaults
compozy dev

# Start with custom port and debug logging
compozy dev --port 3000 --debug

# Custom configuration and watch directories
compozy dev --config ./dev-config.yaml --watch-dir ./custom-tools

# Disable hot reload for testing
compozy dev --no-watch
```

#### Development Features

<FeatureCardList cols={2} size="default">
  <FeatureCard
    title="Hot Reload"
    description="Automatically restarts when configuration, workflows, or tools change for faster development cycles"
    icon="RefreshCw"
  />
  <FeatureCard
    title="Debug Mode"
    description="Enhanced logging, error messages, and execution traces for easier troubleshooting and development"
    icon="Bug"
  />
  <FeatureCard
    title="File Watching"
    description="Monitors workflows, tools, agents, and configuration files for automatic updates and reloading"
    icon="FileSearch"
  />
  <FeatureCard
    title="Performance Profiling"
    description="Built-in CPU, memory, and trace profiling to identify bottlenecks during development"
    icon="BarChart3"
  />
</FeatureCardList>

#### Command Options

```bash
# Server configuration
--port int                # Server port (default: 5001)
--host string             # Server host (default: localhost)

# Development features
--debug                   # Enable debug logging and verbose output
--no-watch               # Disable file watching and hot reload
--watch-dir strings      # Additional directories to watch for changes
--watch-pattern strings  # Custom file patterns to watch

# Configuration
--config string          # Path to configuration file
--env-file string        # Environment variables file
--cwd string             # Working directory for the project

# Profiling and debugging
--profile string         # Enable profiling: cpu, memory, trace
--log-level string       # Log level: debug, info, warn, error (default: info)
```

#### File Watching

The development server automatically monitors and reloads when these files change:

<List>
  <ListItem title="compozy.yaml" icon="Settings">
    Project configuration and global settings
  </ListItem>
  <ListItem title="workflows/**/*.yaml" icon="Workflow">
    Workflow definitions and task configurations
  </ListItem>
  <ListItem title="tools/**/*.ts" icon="Code">
    TypeScript tool implementations
  </ListItem>
  <ListItem title="agents/**/*.yaml" icon="Bot">
    AI agent configurations and instructions
  </ListItem>
  <ListItem title="entrypoint.ts" icon="FileCode">
    Runtime entrypoint for tool execution
  </ListItem>
</List>

#### Development Workflow

<Steps numbered>
  <Step title="Start Development Server" description="Initialize with debug logging enabled">
    ```bash
    compozy dev --debug --log-level debug
    ```
  </Step>
  
  <Step title="Monitor Auto-Reload" description="Server automatically restarts when files change">
    Edit workflows, tools, or configuration files - the server detects changes and reloads automatically.
  </Step>
  
  <Step title="Test Workflows" description="Execute workflows against the development server">
    ```bash
    # In another terminal
    compozy workflow execute my-workflow --input '{"test": true}'
    ```
  </Step>
  
  <Step title="Debug with Enhanced Logging" description="View detailed execution traces and debug information">
    The development server provides:
    - Workflow execution traces
    - Tool invocation details  
    - Error stack traces
    - Performance metrics
    - File change notifications
  </Step>
</Steps>

## Production Server

### compozy start

Launch the production server with optimized performance and security settings:

```bash
# Start production server
compozy start

# Production configuration with custom settings
compozy start --config /etc/compozy/prod.yaml --workers 8

# Structured logging for log aggregation
compozy start --log-json --log-level warn

# Custom database and port configuration
compozy start --port 8080 --db-host prod-db.internal
```

#### Production Features

<FeatureCardList cols={2} size="default">
  <FeatureCard
    title="Performance Optimized"
    description="Production-ready configurations with optimized memory usage, worker pools, and request handling"
    icon="Zap"
  />
  <FeatureCard
    title="Security Hardened"
    description="Strict input validation, CORS controls, authentication enforcement, and security headers"
    icon="Shield"
  />
  <FeatureCard
    title="Structured Logging"
    description="JSON-formatted logs for monitoring systems, log aggregation, and automated analysis"
    icon="FileText"
  />
  <FeatureCard
    title="Resource Management"
    description="Configurable worker pools, connection limits, and graceful shutdown handling"
    icon="Settings"
  />
</FeatureCardList>

#### Command Options

```bash
# Server configuration
--port int                # Server port (default: 5001)
--host string             # Server host (default: 0.0.0.0)
--workers int             # Number of worker processes

# Logging and monitoring
--log-level string        # Log level: debug, info, warn, error (default: info)
--log-json               # Output logs in JSON format for aggregation
--metrics                # Enable metrics endpoints

# Configuration and environment
--config string          # Path to configuration file
--env-file string        # Environment variables file

# Database configuration
--db-host string         # Database host
--db-port string         # Database port
--db-name string         # Database name
--db-user string         # Database username
--db-password string     # Database password
--db-conn-string string  # Full database connection string

# Security and CORS
--auth-enabled           # Enable authentication for API endpoints
--cors                   # Enable CORS (default: true)
--cors-allowed-origins strings  # Allowed CORS origins
```

#### Production Configuration Example

```yaml title="production-config.yaml"
server:
  host: "0.0.0.0"
  port: 5001
  workers: 8
  timeout: 30s

api:
  rate_limit: 1000
  max_request_size: "10MB"
  cors:
    enabled: true
    origins: ["https://app.example.com"]

logging:
  level: "info"
  format: "json"
  output: "stdout"

security:
  auth_enabled: true
  tls:
    enabled: true
    cert_file: "/etc/ssl/certs/compozy.crt"
    key_file: "/etc/ssl/private/compozy.key"

monitoring:
  metrics: true
  health_checks: true
  profiling: false
```

## MCP Proxy Server

### compozy mcp-proxy

Run the Model Context Protocol proxy server for external tool integration:

```bash
# Start MCP proxy with defaults
compozy mcp-proxy

# Custom host and port
compozy mcp-proxy --host 0.0.0.0 --port 8081

# Enable debug logging
compozy mcp-proxy --debug --log-level debug
```

The MCP proxy enables integration with external tools and services through the Model Context Protocol, providing a standardized interface for AI agent tool access.

#### MCP Features

<List>
  <ListItem title="HTTP/SSE Transport" icon="Globe">
    Supports HTTP and Server-Sent Events transport protocols for MCP communication
  </ListItem>
  <ListItem title="Service Discovery" icon="Search">
    Automatic discovery and registration of available MCP servers and their capabilities
  </ListItem>
  <ListItem title="Load Balancing" icon="Scale">
    Request distribution across multiple MCP server instances for high availability
  </ListItem>
  <ListItem title="Security Controls" icon="Lock">
    Authentication, authorization, and request validation for external tool access
  </ListItem>
</List>

## Execution Flow

Here's how the execution commands orchestrate the Compozy system:

<Mermaid chart={`sequenceDiagram
    participant CLI as CLI Command
    participant Server as Compozy Server
    participant DB as PostgreSQL
    participant Redis as Redis Cache
    participant Temporal as Temporal Engine
    participant Runtime as Bun Runtime
    participant MCP as MCP Proxy

    CLI->>Server: compozy dev/start
    Server->>DB: Initialize database connection
    Server->>Redis: Connect to Redis cache
    Server->>Temporal: Initialize workflow engine
    Server->>Runtime: Setup Bun runtime environment
    
    Note over Server: Server startup complete
    
    opt MCP Integration
        CLI->>MCP: compozy mcp-proxy
        MCP->>MCP: Initialize MCP server discovery
        Server->>MCP: Register tool proxy endpoints
    end
    
    Note over Server,Runtime: Ready for workflow execution
    
    Server->>CLI: Server started successfully
    CLI->>CLI: Begin file watching (dev mode)
    
    loop File Changes (dev mode only)
        CLI->>Server: File change detected
        Server->>Server: Reload configuration
        Server->>Runtime: Restart runtime environment
        Server->>CLI: Reload complete
    end`} />

## Health Monitoring

Both development and production servers provide comprehensive health monitoring capabilities:

### Health Check Endpoints

<Tabs items={["Basic Health", "Detailed Health", "Metrics"]}>
<Tab>
Basic health status for load balancer configuration:

```bash
# Check server status
curl http://localhost:5001/health

# Response
{
  "status": "healthy",
  "timestamp": "2024-01-15T10:30:45Z",
  "version": "0.1.0"
}
```
</Tab>

<Tab>
Detailed component health for monitoring systems:

```bash
# Get comprehensive health information
curl http://localhost:5001/health/detailed

# Response
{
  "status": "healthy",
  "timestamp": "2024-01-15T10:30:45Z",
  "version": "0.1.0",
  "components": {
    "database": {
      "status": "healthy",
      "response_time": "2ms",
      "connections": 5
    },
    "redis": {
      "status": "healthy",
      "response_time": "1ms",
      "memory_usage": "45MB"
    },
    "temporal": {
      "status": "healthy",
      "active_workflows": 12,
      "queue_size": 0
    },
    "runtime": {
      "status": "healthy",
      "bun_version": "1.0.25",
      "memory_usage": "128MB"
    }
  },
  "metrics": {
    "uptime": 3600,
    "requests_per_second": 45.2,
    "average_response_time": "125ms"
  }
}
```
</Tab>

<Tab>
Performance metrics for monitoring and alerting:

```bash
# Get performance metrics
curl http://localhost:5001/metrics

# Prometheus-compatible format
# HELP compozy_requests_total Total number of requests
# TYPE compozy_requests_total counter
compozy_requests_total{method="POST",endpoint="/workflows/execute"} 1234
compozy_requests_total{method="GET",endpoint="/health"} 5678

# HELP compozy_request_duration_seconds Request duration
# TYPE compozy_request_duration_seconds histogram
compozy_request_duration_seconds_bucket{le="0.1"} 123
compozy_request_duration_seconds_bucket{le="0.5"} 456
compozy_request_duration_seconds_sum 789.1
```
</Tab>
</Tabs>

### Performance Profiling

Enable performance profiling during development to identify bottlenecks:

```bash
# Enable CPU profiling
compozy dev --profile cpu

# Enable memory profiling  
compozy dev --profile memory

# Enable execution trace profiling
compozy dev --profile trace
```

Profile data is automatically saved to `.compozy/profiles/` for analysis with standard Go profiling tools.

## Environment Configuration

Configure servers using environment variables and configuration files:

<Tabs items={["Development Environment", "Production Environment", "Docker Environment"]}>
<Tab>
```bash title=".env.development"
# Development settings
COMPOZY_LOG_LEVEL=debug
COMPOZY_PORT=5001
COMPOZY_HOST=localhost

# Database configuration
COMPOZY_DB_HOST=localhost
COMPOZY_DB_PORT=5432
COMPOZY_DB_NAME=compozy_dev

# External services
OPENAI_API_KEY=sk-dev-...
GROQ_API_KEY=gsk_dev_...

# Use development environment
compozy dev --env-file .env.development
```
</Tab>

<Tab>
```bash title=".env.production"
# Production settings
COMPOZY_LOG_LEVEL=info
COMPOZY_LOG_FORMAT=json
COMPOZY_PORT=5001
COMPOZY_HOST=0.0.0.0
COMPOZY_WORKERS=8

# Secure database configuration
COMPOZY_DB_HOST=db.production.internal
COMPOZY_DB_PORT=5432
COMPOZY_DB_NAME=compozy_prod
COMPOZY_DB_SSL_MODE=require

# Production API keys
OPENAI_API_KEY=sk-prod-...
GROQ_API_KEY=gsk_prod_...

# Security settings
COMPOZY_AUTH_ENABLED=true
COMPOZY_CORS_ORIGINS=https://app.example.com

# Use production environment
compozy start --env-file .env.production
```
</Tab>

<Tab>
```dockerfile title="Dockerfile"
FROM oven/bun:1.0-alpine

WORKDIR /app
COPY . .

# Install dependencies
RUN bun install

# Environment configuration
ENV COMPOZY_HOST=0.0.0.0
ENV COMPOZY_PORT=5001
ENV COMPOZY_LOG_FORMAT=json

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:5001/health || exit 1

EXPOSE 5001

CMD ["compozy", "start"]
```
</Tab>
</Tabs>

## Process Management

### Graceful Shutdown

Both servers support graceful shutdown for zero-downtime deployments:

```bash
# Send SIGTERM for graceful shutdown
kill -TERM <pid>

# Or use SIGINT (Ctrl+C)
# The server will:
# 1. Stop accepting new requests
# 2. Wait for active workflows to complete (up to 30s)
# 3. Close database and Redis connections
# 4. Shutdown runtime environment
# 5. Exit cleanly with status code 0
```

### Production Deployment

<Tabs items={["systemd", "Docker Compose", "Kubernetes"]}>
<Tab>
```ini title="/etc/systemd/system/compozy.service"
[Unit]
Description=Compozy Workflow Orchestration Server
After=network.target postgresql.service redis.service
Wants=postgresql.service redis.service

[Service]
Type=simple
User=compozy
Group=compozy
WorkingDirectory=/opt/compozy
Environment=COMPOZY_CONFIG=/etc/compozy/config.yaml
ExecStart=/usr/local/bin/compozy start --config /etc/compozy/config.yaml
ExecReload=/bin/kill -USR1 $MAINPID
Restart=always
RestartSec=10
TimeoutStopSec=30

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/lib/compozy /var/log/compozy

[Install]
WantedBy=multi-user.target
```
</Tab>

<Tab>
```yaml title="docker-compose.yml"
version: '3.8'

services:
  compozy:
    image: compozy/compozy:latest
    ports:
      - "5001:5001"
    environment:
      COMPOZY_DB_HOST: postgres
      COMPOZY_REDIS_HOST: redis
      COMPOZY_LOG_FORMAT: json
      COMPOZY_WORKERS: 4
    depends_on:
      - postgres
      - redis
      - temporal
    volumes:
      - ./config:/etc/compozy:ro
      - ./data:/var/lib/compozy
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5001/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: compozy
      POSTGRES_USER: compozy
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
    restart: unless-stopped

volumes:
  postgres_data:
  redis_data:
```
</Tab>

<Tab>
```yaml title="k8s-deployment.yaml"
apiVersion: apps/v1
kind: Deployment
metadata:
  name: compozy-server
  labels:
    app: compozy
spec:
  replicas: 3
  selector:
    matchLabels:
      app: compozy
  template:
    metadata:
      labels:
        app: compozy
    spec:
      containers:
      - name: compozy
        image: compozy/compozy:latest
        ports:
        - containerPort: 5001
        env:
        - name: COMPOZY_HOST
          value: "0.0.0.0"
        - name: COMPOZY_LOG_FORMAT
          value: "json"
        - name: COMPOZY_DB_HOST
          value: "postgres-service"
        livenessProbe:
          httpGet:
            path: /health
            port: 5001
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /health/ready
            port: 5001
          initialDelaySeconds: 5
          periodSeconds: 5
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
```
</Tab>
</Tabs>

## Troubleshooting

Common issues and their solutions:

### Port Conflicts

```bash
# Check what's using the port
lsof -i :5001

# Use a different port
compozy dev --port 3000

# Kill the process using the port
kill -9 $(lsof -t -i:5001)
```

### File Watching Issues

```bash
# Check file watcher limits (Linux)
cat /proc/sys/fs/inotify/max_user_watches

# Increase limits if needed
echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf
sudo sysctl -p

# Disable watching as workaround
compozy dev --no-watch
```

### Memory and Performance

```bash
# Monitor memory usage with profiling
compozy dev --profile memory

# Set memory limits for workers
export NODE_OPTIONS="--max-old-space-size=2048"
compozy start --workers 4

# Check performance profiles
ls -la .compozy/profiles/
```

### Database Connectivity

```bash
# Test database connection
compozy config diagnostics

# Check database status
curl http://localhost:5001/health/detailed | jq '.components.database'

# Verify connection string
compozy start --db-conn-string "postgresql://user:pass@host:5432/dbname" --debug
```

## Best Practices

<List>
  <ListItem title="Use Development Mode for Local Work" icon="Code">
    Always use `compozy dev` during development for better debugging, hot reload, and faster iteration cycles.
  </ListItem>
  
  <ListItem title="Validate Configuration Before Production" icon="CheckCircle">
    Run `compozy config validate --strict` and thoroughly test before deploying with `compozy start`.
  </ListItem>
  
  <ListItem title="Implement Comprehensive Monitoring" icon="BarChart3">
    Use health endpoints, metrics, and structured logging for production monitoring and alerting.
  </ListItem>
  
  <ListItem title="Configure Appropriate Logging Levels" icon="FileText">
    Use debug logging in development but info/warn levels in production to reduce log volume.
  </ListItem>
  
  <ListItem title="Plan for Graceful Shutdowns" icon="Power">
    Implement proper signal handling and health checks for zero-downtime deployments.
  </ListItem>
  
  <ListItem title="Security Configuration" icon="Shield">
    Enable authentication, configure CORS properly, and use TLS in production environments.
  </ListItem>
</List>

## Next Steps

<ReferenceCardList>
  <ReferenceCard
    title="Workflow Commands"
    description="Execute, manage, and monitor workflow lifecycles"
    href="/docs/cli/workflow-commands"
    icon="Workflow"
  />
  <ReferenceCard
    title="Configuration Commands"
    description="Validate and manage Compozy configuration"
    href="/docs/cli/config-commands"
    icon="Settings"
  />
  <ReferenceCard
    title="MCP Commands"
    description="Manage Model Context Protocol servers and integrations"
    href="/docs/cli/mcp-commands"
    icon="Network"
  />
  <ReferenceCard
    title="Monitoring Commands"
    description="Monitor, debug, and analyze workflow performance"
    href="/docs/cli/monitoring-commands"
    icon="BarChart3"
  />
</ReferenceCardList>
