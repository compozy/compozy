---
title: "Temporal Modes"
description: "Choose between memory, persistent, and distributed Temporal deployments for Compozy."
icon: GitBranch
---

<Callout type="warning">
Use `distributed` mode for every production environment. Memory and persistent modes embed Temporal inside the Compozy process for development and CI only.
</Callout>

## Mode Comparison

<Table>
  <TableHeader>
    <TableRow>
      <TableHead>Capability</TableHead>
      <TableHead>Memory</TableHead>
      <TableHead>Persistent</TableHead>
      <TableHead>Distributed</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    <TableRow>
      <TableCell>Target environment</TableCell>
      <TableCell>Local prototyping, workshops, smoke tests</TableCell>
      <TableCell>Team development, deterministic CI pipelines</TableCell>
      <TableCell>Staging, production, shared infrastructure</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>Runtime</TableCell>
      <TableCell>Embedded `temporal.NewServer()` with in-memory SQLite</TableCell>
      <TableCell>Embedded `temporal.NewServer()` with file-backed SQLite</TableCell>
      <TableCell>External Temporal cluster (Temporal Cloud or self-managed)</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>Persistence</TableCell>
      <TableCell>Ephemeral (`:memory:`)</TableCell>
      <TableCell>Durable SQLite file on disk</TableCell>
      <TableCell>Managed database (Cassandra, MySQL, PostgreSQL)</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>High availability</TableCell>
      <TableCell>Single process</TableCell>
      <TableCell>Single process</TableCell>
      <TableCell>Multi-node cluster with failover</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>Web UI</TableCell>
      <TableCell>Optional on port 8233</TableCell>
      <TableCell>Optional on port 8233</TableCell>
      <TableCell>Deployed separately</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>Default ports</TableCell>
      <TableCell>Frontend 7233, History 7234, Matching 7235, Worker 7236, UI 8233</TableCell>
      <TableCell>Frontend 7233, History 7234, Matching 7235, Worker 7236, UI 8233</TableCell>
      <TableCell>Depends on cluster (commonly 7233)</TableCell>
    </TableRow>
    <TableRow>
      <TableCell>Startup latency</TableCell>
      <TableCell>&lt;10 seconds, typically sub-second</TableCell>
      <TableCell>&lt;10 seconds (slightly slower due to file sync)</TableCell>
      <TableCell>Depends on network + upstream availability</TableCell>
    </TableRow>
  </TableBody>
</Table>

## Architecture Overview

<Mermaid chart={`flowchart LR
  subgraph Distributed Cluster
    F[Frontend Services]
    H[History Services]
    M[Matching Services]
    W[Worker Services]
    DB[(Managed Persistence)]
    F --> H
    H --> DB
    M --> DB
    W --> DB
  end

  subgraph Compozy (memory/persistent)
    subgraph Embedded Temporal
      FE[Frontend 7233]
      HI[History 7234]
      MA[Matching 7235]
      WO[Worker 7236]
      DB2[(SQLite :memory: or file)]
    end
    UI[Temporal UI 8233]
  end

  Compozy -.-> UI
  FE --> DB2
  HI --> DB2
  MA --> DB2
  WO --> DB2
  F -->|gRPC 7233| Compozy
`} />

<Callout type="info">
Switching between modes changes orchestration, not workflow semantics. The embedded server runs the same Temporal binaries used in distributed clusters.
</Callout>

## Distributed Mode (Production)

Use distributed mode whenever you need durability, multi-node availability, or shared infrastructure.

```yaml title="temporal (distributed)"
temporal:
  mode: distributed
  host_port: temporal.prod.internal:7233
  namespace: compozy-prod
  task_queue: compozy-tasks
```

```bash title="CLI override"
compozy start --temporal-mode=distributed --temporal-host=temporal.prod.internal:7233
```

- Provision namespaces per environment and align retention policies with compliance needs.
- Enable mTLS or mutual auth on the Temporal gateway.
- Monitor latency, workflow backlog, and activity heartbeats via Temporal metrics.

## Memory Mode (Ephemeral Development)

Memory mode spins up Temporal in-process with fully in-memory persistence. It is ideal for tutorials, spikes, and tests that can discard state between runs.

```yaml title="temporal (memory)"
temporal:
  mode: memory
  host_port: localhost:7233
  standalone:
    database_file: :memory:
    frontend_port: 7233
    bind_ip: 127.0.0.1
    namespace: default
    cluster_name: compozy-memory
    enable_ui: true
    ui_port: 8233
    log_level: warn
    start_timeout: 30s
```

```bash title="Quick start"
compozy start --temporal-mode=memory --temporal-standalone-database=:memory:
```

<Callout type="warning">
Memory mode erases workflow history on every restart. Do not rely on it for debugging sessions that span multiple executions.
</Callout>

## Persistent Mode (Durable Embedded)

Persistent mode keeps the embedded topology but stores Temporal history on disk. Pick this when you need to pause/resume development without losing state or when integration tests require reproducible history.

```yaml title="temporal (persistent)"
temporal:
  mode: persistent
  host_port: localhost:7233
  standalone:
    database_file: ./.compozy/temporal.db
    frontend_port: 9733
    bind_ip: 127.0.0.1
    namespace: default
    cluster_name: compozy-persistent
    enable_ui: true
    ui_port: 9833
    log_level: info
    start_timeout: 45s
```

```bash title="Durable local run"
compozy start --temporal-mode=persistent --temporal-standalone-database=./.compozy/temporal.db
```

- Shared CI pipelines can mount a writable volume to preserve the SQLite database between test stages.
- Increase `temporal.standalone.start_timeout` on slower machines to avoid flakiness.
- When finished, delete the database file to reclaim disk space.

## Migrating Between Modes

<Steps size="sm">
  <Step title="Plan the migration">
    Audit workflows, ensure retries are idempotent, and determine the target mode (memory/persistent/distributed).
  </Step>
  <Step title="Update configuration">
    Change `temporal.mode` and related fields in `compozy.yaml`. Remove or adjust the `temporal.standalone` block when switching between embedded and distributed deployments.
  </Step>
  <Step title="Rotate secrets & endpoints">
    Adjust environment variables (`TEMPORAL_MODE`, `TEMPORAL_HOST_PORT`, `TEMPORAL_EMBEDDED_*`) and restart any long-running workers.
  </Step>
  <Step title="Verify connectivity">
    For distributed mode, run `temporal namespace describe`. For embedded modes, open `http://localhost:8233` to confirm the UI is available.
  </Step>
</Steps>

<Callout type="success">
Pin `temporal.mode` per environment in configuration management so that accidental overrides do not promote embedded modes to production.
</Callout>

## Resources

<ReferenceCardList cols={2}>
  <ReferenceCard
    title="Temporal Configuration"
    description="Field-by-field description of `temporal` options"
    href="/docs/configuration/temporal"
    icon="Settings"
  />
  <ReferenceCard
    title="Embedded Temporal Architecture"
    description="Understand the four-service layout, lifecycle hooks, and SQLite storage"
    href="/docs/architecture/embedded-temporal"
    icon="Layers"
  />
  <ReferenceCard
    title="Memory Mode Deployment"
    description="Zero-dependency setup with in-process services"
    href="/docs/deployment/memory-mode"
    icon="Rocket"
  />
  <ReferenceCard
    title="Persistent Mode Deployment"
    description="Embedded services with disk-backed durability"
    href="/docs/deployment/persistent-mode"
    icon="Folder"
  />
  <ReferenceCard
    title="Mode Migration Guide"
    description="Transition from legacy standalone configs to memory or persistent"
    href="/docs/guides/mode-migration-guide"
    icon="ArrowRightLeft"
  />
</ReferenceCardList>
