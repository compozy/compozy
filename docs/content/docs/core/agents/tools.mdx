---
title: "Agent Tools"
description: Tools extend agent capabilities by providing access to external functions, APIs, and services. When tools are configured, agents can dynamically decide when and how to use them to complete tasks, enabling powerful automation workflows.
---

## How Tools Work with Agents

When an agent has tools available:

1. **Tool Discovery**: The agent receives descriptions of available tools
2. **Decision Making**: Based on the task, the agent decides if and which tools to use
3. **Tool Invocation**: The agent calls tools with appropriate parameters
4. **Result Integration**: Tool outputs are incorporated into the agent's response

## Tool Configuration

### Understanding Tool Patterns

Compozy uses three distinct patterns for working with tools:

<List icon="Package">
  <ListItem title="Tool Definition">
    Define tools in separate files with `resource: tool`. This creates reusable tool components.
  </ListItem>
  <ListItem title="Tool Reference in Agents">
    Reference tools in agent configurations using `$ref: local::tools.#(id=="tool-id")`.
  </ListItem>
  <ListItem title="Tool Usage in Tasks">
    Use tools in task configurations with `$use: tool(local::tools.#(id="tool-id"))`.
  </ListItem>
</List>

### Basic Tool Assignment

Assign tools to agents in the agent configuration:

```yaml
agents:
  - id: data-processor
    config:
      provider: openai
      model: gpt-4-turbo-preview
    instructions: |
      You are a data processing assistant.
      Use available tools to fetch, process, and analyze data.
    tools:
      - $ref: local::tools.#(id=="fetch-data")
      - $ref: local::tools.#(id=="transform-data")
      - $ref: local::tools.#(id=="save-results")
```

### Tool References

Tools must be defined separately and then referenced in agent configurations:

<Callout type="warning">
  Tools cannot be defined inline within agent configurations. They must be defined in separate files with `resource: tool` and then referenced using `$ref` patterns.
</Callout>

<Tabs items={["Local Reference", "Resource Reference (Required)"]} defaultValue="Local Reference">
  <Tab value="Local Reference">
    ```yaml
    # Reference tools defined in the same workflow file
    tools:
      - $ref: local::tools.#(id=="weather_tool")
      - $ref: local::tools.#(id=="calculator")
    ```
  </Tab>

  <Tab value="Resource Reference (Required)">
    ```yaml
    # Tool definition (in separate tool files)
    resource: tool  # REQUIRED for tool discovery
    id: file-reader
    name: File Reader
    description: "Reads file contents"
    input:
      type: object
      properties:
        path:
          type: string
          description: "File path to read"

    # Reference in agent configuration
    agents:
      - id: my-agent
        tools:
          - $ref: local::tools.#(id=="file-reader")
    ```
  </Tab>
</Tabs>

## Tool Inheritance

Agents can inherit tools defined at the project and workflow levels so you don't have to repeat shared tool lists everywhere.

<List>
  <ListItem title="Precedence">
    Agent tools > Workflow tools > Project tools. If an agent declares any tools, inheritance is disabled for that agent.
  </ListItem>
  <ListItem title="Deterministic Ordering">
    Inherited tools are merged and then sorted alphabetically by ID before being advertised to the LLM.
  </ListItem>
  <ListItem title="Where to Define">
    Use <code>tools:</code> in <code>compozy.yaml</code> for shared tools, <code>tools:</code> in workflows for workflow‑specific overrides, and <code>tools:</code> in agents when you need explicit control.
  </ListItem>
</List>

```yaml title="Project-level tools (compozy.yaml)"
tools:
  - id: read_file
    description: Read the contents of a file
  - id: write_file
    description: Write content to a file
```

```yaml title="Workflow overrides (workflow.yaml)"
tools:
  - id: write_file
    description: Write with workflow policies
```

```yaml title="Agent inheritance (agent.yaml)"
# No tools declared here → agent inherits project/workflow tools.
agents:
  - id: analyzer
    config:
      provider: openai
      model: gpt-4o
```

## Tool Usage Patterns

### Automatic Tool Selection

By default, agents automatically decide when to use tools:

```yaml
config:
  provider: openai
  model: gpt-4-turbo-preview
  tool_choice: auto  # Default behavior

actions:
  - id: process-request
    prompt: |
      Process the user's request using available tools as needed.
      Request: {{.input.request}}
```

### Forced Tool Usage

Force the agent to use a specific tool:

```yaml
config:
  tool_choice: "weather_tool"  # Force specific tool

# Or disable tool usage
config:
  tool_choice: none
```


## MCP Tools

Agents can use tools provided by MCP (Model Context Protocol) servers. MCP servers must be configured in the `mcps` field, separate from standard tools:

<Callout type="warning">
  MCP servers are configured in the `mcps` field, not in the `tools` array. Standard tools and MCP tools are managed separately.
</Callout>

```yaml
agents:
  - id: system-admin
    instructions: |
      You are a system administrator with access to server tools.
    # Standard tools (defined with resource: tool)
    tools:
      - $ref: local::tools.#(id=="log-analyzer")
    # MCP servers (separate configuration)
    mcps:
      - id: filesystem
        transport: stdio
        command: npx
        args: ["-y", "@modelcontextprotocol/server-filesystem", "/"]

    actions:
      - id: check-logs
        prompt: |
          Use the MCP filesystem tools to:
          1. List files in /var/log
          2. Read the most recent error logs
          3. Summarize any critical issues found
```
