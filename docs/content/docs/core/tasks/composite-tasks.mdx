---
title: Composite Tasks
description: Master sequential workflow orchestration with composite tasks that group related operations into logical, reusable units with sophisticated strategy control and error handling
---

<Callout type="info" title="When to Use Composite Tasks" className="mt-8">
  Perfect for multi-step processes like user onboarding, document processing pipelines, or any workflow where tasks must execute in a specific order. For independent operations that can run simultaneously, consider [parallel processing](/docs/core/tasks/parallel-processing) instead.
</Callout>

## Overview

Composite tasks are the **sequential orchestration engine** of Compozy workflows, enabling you to group related tasks into logical units that execute one after another. They transform complex multi-step processes into reusable, maintainable components while providing sophisticated control over execution strategies and comprehensive error handling.

<FeatureCardList cols={2} size="default">
  <FeatureCard
    title="Sequential Execution"
    description="Tasks execute one after another, with each task waiting for the previous to complete, ensuring proper dependency management"
    icon="ArrowRight"
  />
  <FeatureCard
    title="Strategy Control"
    description="Choose between fail_fast for critical processes or best_effort for resilient operations with configurable error handling"
    icon="GitBranch"
  />
  <FeatureCard
    title="Data Flow Integration"
    description="Outputs from each task automatically become available to subsequent tasks through template expressions"
    icon="Workflow"
  />
  <FeatureCard
    title="Hierarchical Composition"
    description="Composite tasks can contain other composite tasks, enabling complex nested workflows with different strategies"
    icon="Layers"
  />
</FeatureCardList>

## Task Structure

Every composite task shares this fundamental structure:

```yaml
id: task-name
type: composite
strategy: fail_fast # or best_effort
tasks:
  - id: first-task
    type: basic
    action: process_message
    with:
      data: "{{ .workflow.input.data }}"
  - id: second-task
    type: basic
    action: format_output
    with:
      processed_data: "{{ .tasks.first-task.output.result }}"
outputs:
  result: "{{ .tasks.second-task.output.result }}"
on_success:
  next: next-workflow-task
on_error:
  next: error-handler
```

## Execution Strategies

Composite tasks support two distinct execution strategies that determine how failures are handled during sequential execution. Understanding these strategies is crucial for building robust workflows that match your business requirements.

<Tabs items={["Fail Fast Strategy", "Best Effort Strategy"]}>
<Tab value="Fail Fast Strategy">

The `fail_fast` strategy (default) provides **strict error handling** by stopping execution immediately when any task fails. This strategy is essential for workflows where the integrity of the entire process depends on every step succeeding.

```yaml
id: financial-transaction
type: composite
strategy: fail_fast  # Critical for financial operations

tasks:
  - id: validate-account
    type: basic
    action: validate_account
    with:
      account_id: "{{ .workflow.input.account_id }}"
      amount: "{{ .workflow.input.amount }}"

  - id: check-balance
    type: basic
    action: check_account_balance
    with:
      account_id: "{{ .workflow.input.account_id }}"
      required_amount: "{{ .workflow.input.amount }}"

  - id: process-transaction
    type: basic
    action: process_financial_transaction
    with:
      account_id: "{{ .workflow.input.account_id }}"
      amount: "{{ .workflow.input.amount }}"
      validation_result: "{{ .tasks.validate-account.output.result }}"

# If any task fails, the entire composite fails immediately
# No subsequent tasks will execute
```

<List className="mt-8">
  <ListItem title="Critical Process Integrity" icon="Shield">
    Use when all tasks must succeed for the process to be valid - perfect for financial transactions, legal workflows, or security-sensitive operations
  </ListItem>
  <ListItem title="Dependency Chain Requirements" icon="Link">
    Ideal when failure of any step makes subsequent steps meaningless or dangerous to execute
  </ListItem>
  <ListItem title="System Consistency" icon="Database">
    Essential for maintaining data consistency and system integrity where partial completion could cause corruption
  </ListItem>
  <ListItem title="Compliance and Audit" icon="FileCheck">
    Required for workflows that need complete audit trails and cannot have partial execution states
  </ListItem>
</List>

<Callout type="warning" className="mt-8">
**Fail Fast Best Practices**: Always implement proper error handling and consider rollback strategies when using fail_fast for critical operations. Learn more about advanced patterns and [workflow configuration](/docs/core/configuration/workflows) for transient failures.
</Callout>

</Tab>
<Tab value="Best Effort Strategy">

The `best_effort` strategy provides **resilient execution** by continuing the workflow even when some tasks fail. This approach maximizes the value extracted from successful operations while gracefully handling partial failures.

```yaml
id: data-enrichment-pipeline
type: composite
strategy: best_effort  # Continue despite failures

tasks:
  - id: extract-basic-info
    type: basic
    action: extract_basic_info
    with:
      data: "{{ .workflow.input.raw_data }}"

  - id: enrich-with-external-api
    type: basic
    action: enrich_data_external
    with:
      basic_info: "{{ .tasks.extract-basic-info.output.info }}"
    # This might fail due to API issues, but we continue

  - id: apply-ml-analysis
    type: basic
    action: analyze_with_ml
    with:
      data: "{{ .tasks.extract-basic-info.output.info }}"
      enriched_data: "{{ .tasks.enrich-with-external-api.output.data | default dict }}"
    # This runs even if external enrichment failed

  - id: generate-report
    type: basic
    action: generate_data_report
    with:
      basic_info: "{{ .tasks.extract-basic-info.output.info }}"
      enriched_data: "{{ .tasks.enrich-with-external-api.output.data | default dict }}"
      analysis: "{{ .tasks.apply-ml-analysis.output.analysis | default dict }}"

outputs:
  # Collect all available results
  basic_info: "{{ .tasks.extract-basic-info.output.info }}"
  enriched_data: "{{ .tasks.enrich-with-external-api.output.data | default null }}"
  analysis: "{{ .tasks.apply-ml-analysis.output.analysis | default null }}"
  report: "{{ .tasks.generate-report.output.report }}"

  # Track which tasks succeeded/failed
  enrichment_success: "{{ not .tasks.enrich-with-external-api.error }}"
  analysis_success: "{{ not .tasks.apply-ml-analysis.error }}"
  overall_success: "{{ not .task.error }}"
```

<List className="mt-8">
  <ListItem title="Optional Enhancement Tasks" icon="Plus">
    Perfect when some tasks provide additional value but aren't critical - like data enrichment, analytics, or notification tasks
  </ListItem>
  <ListItem title="Valuable Partial Results" icon="Target">
    Use when partial completion still delivers meaningful value to users or downstream processes
  </ListItem>
  <ListItem title="External Service Resilience" icon="Cloud">
    Essential for workflows dependent on third-party APIs or services that may experience intermittent failures
  </ListItem>
  <ListItem title="Data Collection Scenarios" icon="Download">
    Ideal for gathering data from multiple sources where some sources might be temporarily unavailable
  </ListItem>
</List>

<Callout type="warning" className="mt-8">
**Best Effort Optimization**: Use [conditional execution](/docs/core/yaml-templates/context-variables) with template expressions to skip dependent tasks when prerequisites fail. Combine with [aggregate tasks](/docs/core/tasks/aggregate-tasks) to collect and process partial results.
</Callout>

</Tab>
</Tabs>

## Hierarchical Organization

One of the most powerful features of composite tasks is their ability to contain other composite tasks, creating **hierarchical workflow structures**. This enables you to build complex, multi-layered processes while maintaining clear organization and different error handling strategies at each level.

<Mermaid className="mt-8" chart={`graph LR
    subgraph "Parent Composite (fail_fast)"
        A["Processing Composite (best_effort)"]
        B["Analysis Composite (fail_fast)"]
        C["Output Composite (best_effort)"]
    end

    subgraph "Processing Composite"
        A1[Extract Text]
        A2[Extract Images]
        A3[Extract Metadata]
    end

    subgraph "Analysis Composite"
        B1[Analyze Text]
        B2[Analyze Structure]
    end

    subgraph "Output Composite"
        C1[Create Summary]
        C2[Create Report]
    end

    A --> B
    B --> C

    A -.-> A1
    A -.-> A2
    A -.-> A3

    B -.-> B1
    B -.-> B2

    C -.-> C1
    C -.-> C2

    style A fill:#101010,color:#fff
    style B fill:#101010,color:#fff
    style C fill:#101010,color:#fff`} />

### Strategy Inheritance and Override

Hierarchical composite tasks allow you to apply **different strategies at different levels**:

```yaml
id: complete-document-pipeline
type: composite
strategy: fail_fast

tasks:
  - id: document-processing
    type: composite
    strategy: best_effort  # Some processing steps can fail
    tasks:
      - id: extract-text
        type: basic
        action: extract_document_text
        with:
          document: "{{ .workflow.input.document }}"

      - id: extract-images
        type: basic
        action: extract_document_images
        with:
          document: "{{ .workflow.input.document }}"

      - id: extract-metadata
        type: basic
        action: extract_document_metadata
        with:
          document: "{{ .workflow.input.document }}"

  - id: content-analysis
    type: composite
    strategy: fail_fast  # Analysis must be complete
    tasks:
      - id: analyze-text
        type: basic
        action: analyze_text_content
        with:
          text: "{{ .tasks.document-processing.tasks.extract-text.output.content }}"

      - id: analyze-structure
        type: basic
        action: analyze_document_structure
        with:
          text: "{{ .tasks.document-processing.tasks.extract-text.output.content }}"
          metadata: "{{ .tasks.document-processing.tasks.extract-metadata.output.metadata }}"

  - id: generate-outputs
    type: composite
    strategy: best_effort  # Some outputs are optional
    tasks:
      - id: create-summary
        type: basic
        action: create_document_summary
        with:
          text_analysis: "{{ .tasks.content-analysis.tasks.analyze-text.output.analysis }}"
          structure_analysis: "{{ .tasks.content-analysis.tasks.analyze-structure.output.structure }}"

      - id: create-keywords
        type: basic
        action: extract_keywords
        with:
          text_analysis: "{{ .tasks.content-analysis.tasks.analyze-text.output.analysis }}"

      - id: create-report
        type: basic
        action: generate_final_report
        with:
          summary: "{{ .tasks.create-summary.output.summary }}"
          keywords: "{{ .tasks.create-keywords.output.keywords }}"
          raw_data: "{{ .tasks.document-processing.outputs }}"

outputs:
  processing_results: "{{ .tasks.document-processing.outputs }}"
  analysis_results: "{{ .tasks.content-analysis.outputs }}"
  final_outputs: "{{ .tasks.generate-outputs.outputs }}"

  # High-level summary
  document_summary: "{{ .tasks.generate-outputs.tasks.create-summary.output.summary }}"
  keywords: "{{ .tasks.generate-outputs.tasks.create-keywords.output.keywords }}"
  full_report: "{{ .tasks.generate-outputs.tasks.create-report.output.report }}"
```

## Best Practices

Successful composite task implementation requires careful consideration of strategy selection, data flow design, and error handling patterns. These practices ensure your workflows are maintainable, reliable, and performant.

<AccordionGroup>
  <Accordion title="Strategy Selection Guidelines" defaultOpen>

<List>
  <ListItem title="Fail Fast for Critical Paths" icon="AlertTriangle">
    Use fail_fast for workflows where partial completion could cause data inconsistency or business rule violations
  </ListItem>
  <ListItem title="Best Effort for Enhancement" icon="TrendingUp">
    Choose best_effort when tasks provide additional value but system functionality doesn't depend on their success
  </ListItem>
  <ListItem title="Mixed Strategies for Complex Flows" icon="GitBranch">
    Use hierarchical composition to apply different strategies at different levels - strict for core operations, resilient for enhancements
  </ListItem>
</List>

  </Accordion>

  <Accordion title="Performance Optimization">

<List>
  <ListItem title="Minimize Data Passing" icon="Zap">
    Pass only necessary data between tasks - avoid copying large objects when task IDs or references suffice
  </ListItem>
  <ListItem title="Set Appropriate Timeouts" icon="Clock">
    Configure realistic timeouts for each task based on expected execution time and external dependencies
  </ListItem>
  <ListItem title="Consider Parallel Alternatives" icon="Zap">
    Evaluate if independent tasks could use [parallel processing](/docs/core/tasks/parallel-processing) instead of sequential execution
  </ListItem>
  <ListItem title="Use Memory Tasks for State" icon="Database">
    For long-running processes, implement [memory tasks](/docs/core/tasks/memory-tasks) to maintain state across workflow executions
  </ListItem>
</List>

  </Accordion>

  <Accordion title="Error Handling and Recovery">

<List>
  <ListItem title="Plan Recovery Scenarios" icon="Shield">
    Design fallback tasks and recovery procedures for critical workflow steps
  </ListItem>
  <ListItem title="Implement Retry Policies" icon="RotateCcw">
    Configure appropriate retry strategies for transient failures, especially for external service calls
  </ListItem>
  <ListItem title="Design Meaningful Outputs" icon="FileOutput">
    Create outputs that provide sufficient context for debugging and downstream processing
  </ListItem>
  <ListItem title="Use Signal Coordination" icon="Radio">
    Leverage [signal tasks](/docs/core/tasks/signal-tasks) for cross-workflow coordination and external event handling
  </ListItem>
</List>

  </Accordion>
</AccordionGroup>

<Callout type="success" className="mt-8">
**Composite Task Mastery**: Once you've mastered basic composite patterns, explore [collection tasks](/docs/core/tasks/collection-tasks) for array processing and [router tasks](/docs/core/tasks/router-tasks) for dynamic branching. These task types complement composite tasks to create sophisticated workflow architectures.
</Callout>

## Next Steps

Composite tasks are central to Compozy's workflow orchestration capabilities. Understanding how they integrate with other task types and system components will help you build sophisticated, production-ready workflows.

<Tabs items={["Prerequisites", "Related Patterns", "Advanced Integration", "Production Examples"]}>
<Tab>

**Essential Foundation Knowledge**:

<ReferenceCardList>
  <ReferenceCard
    title="Basic Tasks"
    description="Master the fundamental building blocks that form the foundation of all composite task workflows"
    href="/docs/core/tasks/basic-tasks"
    icon="Package"
  />
  <ReferenceCard
    title="Agent Integration"
    description="Learn how AI agents work within composite workflows for intelligent task execution"
    href="/docs/core/agents/overview"
    icon="Bot"
  />
  <ReferenceCard
    title="Tool Development"
    description="Understand how to build and integrate custom tools for specialized composite task operations"
    href="/docs/core/tools/overview"
    icon="Wrench"
  />
  <ReferenceCard
    title="YAML Templates"
    description="Master the template system that powers dynamic data flow between composite task steps"
    href="/docs/core/yaml-templates/overview"
    icon="FileCode"
  />
</ReferenceCardList>

</Tab>
<Tab>

**Complementary Task Patterns**:

<ReferenceCardList>
  <ReferenceCard
    title="Parallel Processing"
    description="Execute independent operations simultaneously - the perfect complement to sequential composite tasks"
    href="/docs/core/tasks/parallel-processing"
    icon="Zap"
  />
  <ReferenceCard
    title="Router Tasks"
    description="Add intelligent conditional branching and decision-making to your composite workflows"
    href="/docs/core/tasks/router-tasks"
    icon="GitBranch"
  />
  <ReferenceCard
    title="Collection Tasks"
    description="Process arrays and datasets with composite task templates for sophisticated batch operations"
    href="/docs/core/tasks/collection-tasks"
    icon="List"
  />
  <ReferenceCard
    title="Aggregate Tasks"
    description="Combine and process results from multiple composite task executions"
    href="/docs/core/tasks/aggregate-tasks"
    icon="BarChart3"
  />
</ReferenceCardList>

</Tab>
<Tab>

**Advanced System Integration**:

<ReferenceCardList>
  <ReferenceCard
    title="Signal Coordination"
    description="Coordinate composite tasks across different workflows and external systems"
    href="/docs/core/tasks/signal-tasks"
    icon="Radio"
  />
  <ReferenceCard
    title="Memory Systems"
    description="Add persistent state management to long-running composite workflows"
    href="/docs/core/tasks/memory-tasks"
    icon="Database"
  />
  <ReferenceCard
    title="Advanced Patterns"
    description="Implement comprehensive error handling and recovery strategies for production workflows"
    href="/docs/core/tasks/parallel-processing"
    icon="Shield"
  />
  <ReferenceCard
    title="MCP Integration"
    description="Connect external tools and services to enhance composite task capabilities"
    href="/docs/core/mcp/overview"
    icon="Link"
  />
</ReferenceCardList>

</Tab>
<Tab>

**Real-World Implementation Examples**:

<ReferenceCardList>
  <ReferenceCard
    title="Quick Start Guide"
    description="Build your first composite workflow with step-by-step instructions and practical examples"
    href="/docs/core/getting-started/quick-start"
    icon="UserPlus"
  />
  <ReferenceCard
    title="First Workflow Tutorial"
    description="Complete tutorial showing sequential task execution patterns and data flow management"
    href="/docs/core/getting-started/first-workflow"
    icon="FileText"
  />
  <ReferenceCard
    title="Advanced Task Patterns"
    description="Sophisticated workflow orchestration techniques including error handling and resilience"
    href="/docs/core/tasks/parallel-processing"
    icon="ShoppingCart"
  />
  <ReferenceCard
    title="Flow Control Patterns"
    description="Complex workflow coordination with conditional logic and dynamic routing"
    href="/docs/core/tasks/composite-tasks"
    icon="GitBranch"
  />
</ReferenceCardList>

</Tab>
</Tabs>
