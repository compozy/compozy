---
title: Parallel Processing
description: Parallel tasks enable concurrent execution of multiple operations, dramatically improving workflow performance while providing sophisticated control over execution strategies. They're essential for scalable workflows that need to process independent operations simultaneously.
---

## Task Structure

```yaml
id: parallel-task-example
type: parallel

# Strategy (Required): Determines how task execution and failures are handled
strategy: wait_all  # wait_all | fail_fast | best_effort | race

# Worker Pool (Optional): Control concurrent execution
max_workers: 4      # Maximum concurrent tasks (0 = unlimited)
timeout: 5m         # Overall timeout for all tasks

# Task Definitions (Required): Array of tasks to execute in parallel
tasks:
  - id: task-1
    type: basic
    # ... task configuration

  - id: task-2
    type: basic
    # ... task configuration

# Success Handler (Optional): Execute when parallel task completes
on_success:
  next: downstream-task
  with:
    results: "{{ .output }}"
    execution_time: "{{ .execution.duration }}"

# Error Handler (Optional): Handle failures based on strategy
on_error:
  next: error-handler
  with:
    failed_tasks: "{{ .failed_tasks }}"
    error: "{{ .error }}"
```

## Key Benefits

<FeatureCardList cols={3} size="sm">
  <FeatureCard
    title="Performance Multiplier"
    description="Transform sequential 30s workflows into 10s parallel execution with smart concurrency control"
    icon="Zap"
  />
  <FeatureCard
    title="Strategic Execution"
    description="Four execution strategies optimized for different reliability and performance requirements"
    icon="Settings"
  />
  <FeatureCard
    title="Resource Intelligence"
    description="Adaptive worker management with automatic queuing and timeout handling"
    icon="Gauge"
  />
</FeatureCardList>

## Execution Strategies

Strategic control over parallel execution behavior and failure handling:

<Tabs items={["Wait All", "Fail Fast", "Best Effort", "Race"]}>
<Tab value="Wait All">

**Default Strategy** - Waits for all tasks to complete before proceeding.

<Mermaid className="my-14" chart={`graph LR
    A[Start Parallel Tasks] --> B[Task 1]
    A --> C[Task 2]
    A --> D[Task 3]
    B --> E{All Tasks Complete?}
    C --> E
    D --> E
    E -->|Yes| F[Success]
    E -->|Any Failed| G[Error]

    style F fill:#1B6F2F
    style G fill:#6B1920`} />

```yaml title="Comprehensive Data Gathering"
id: comprehensive-data-gathering
type: parallel
strategy: wait_all  # [!code highlight]
max_workers: 3
timeout: 10m

tasks:
  - id: task-1
    type: basic
    # ... task configuration

  - id: task-2
    type: basic
    # ... task configuration
```

<Callout type="info">
**Best for:** Data aggregation, comprehensive processing where all results are required for downstream tasks.
</Callout>

</Tab>

<Tab value="Fail Fast">

**Fail Fast Strategy** - Stops execution immediately when any task fails.

<Mermaid className="my-14" chart={`graph LR
    A[Start Parallel Tasks] --> B[Task 1]
    A --> C[Task 2]
    A --> D[Task 3]
    B --> E{Any Task Failed?}
    C --> E
    D --> E
    E -->|Yes| F[Cancel Running Tasks]
    F --> G[Immediate Failure]
    E -->|No| H{All Tasks Complete?}
    H -->|Yes| I[Success]

    style G fill:#6B1920
    style I fill:#1B6F2F`} />

```yaml title="Payment Security Validation"
id: payment-security-validation
type: parallel
strategy: fail_fast  # [!code highlight]
max_workers: 0       # Unlimited - all validations run immediately
timeout: 30s         # Quick timeout for security checks

tasks:
  - id: task-1
    type: basic
    # ... task configuration

  - id: task-2
    type: basic
    # ... task configuration
```

<Callout type="warning">
**Best for:** Critical validations, security checks, payment processing where any failure invalidates the entire operation.
</Callout>

</Tab>

<Tab value="Best Effort">

**Best Effort Strategy** - Continues execution despite individual task failures.

<Mermaid className="my-14" chart={`graph LR
    A[Start Parallel Tasks] --> B[Task 1]
    A --> C[Task 2]
    A --> D[Task 3]
    B --> E{All Tasks Attempted?}
    C --> E
    D --> E
    E -->|Yes| F[Success]
    F --> G[Include Both Successes and Failures]

    style F fill:#1B6F2F
    style G fill:#FFC107,color:#000`} />

```yaml title="Multi-Channel Notification"
id: multi-channel-notification
type: parallel
strategy: best_effort  # [!code highlight]
timeout: 60s

tasks:
  - id: task-1
    type: basic
    # ... task configuration

  - id: task-2
    type: basic
    # ... task configuration
```

<Callout type="success">
**Best for:** Notification systems, optional operations, monitoring tasks where partial success is acceptable.
</Callout>

</Tab>

<Tab value="Race">

**Race Strategy** - Returns as soon as the first task completes successfully.

<Mermaid className="my-14" chart={`graph LR
    A[Start Parallel Tasks] --> B[Task 1]
    A --> C[Task 2]
    A --> D[Task 3]
    B --> E{First Task Success?}
    C --> E
    D --> E
    E -->|Yes| F[Cancel Remaining Tasks]
    F --> G[Success]
    E -->|All Failed| H[Error]

    style G fill:#1B6F2F
    style H fill:#6B1920`} />

```yaml title="Fastest Data Source Selection"
id: fastest-data-source
type: parallel
strategy: race      # [!code highlight]
timeout: 10s

tasks:
  - id: task-1
    type: basic
    # ... task configuration

  - id: task-2
    type: basic
    # ... task configuration
```

<Callout type="info">
**Best for:** Redundant services, speed optimization, fallback scenarios, competitive data sources.
</Callout>

</Tab>
</Tabs>

## Architecture & Execution Flow

Understanding how parallel processing works under the hood:

<Mermaid chart={`sequenceDiagram
    participant Workflow
    participant ParallelTask as Parallel Task Engine
    participant Temporal as Temporal Orchestrator
    participant Worker1 as Worker Pool 1
    participant Worker2 as Worker Pool 2
    participant Worker3 as Worker Pool 3
    participant StateStore as State Store

    Workflow->>ParallelTask: Execute parallel task
    ParallelTask->>StateStore: Create parent state
    ParallelTask->>Temporal: Start parallel workflow

    Note over ParallelTask,Worker3: Strategy: wait_all, max_workers: 3

    Temporal->>Worker1: Allocate task 1
    Temporal->>Worker2: Allocate task 2
    Temporal->>Worker3: Allocate task 3

    Note over Worker1,Worker3: Concurrent execution with isolation

    Worker2->>StateStore: Update task 2 state (success)
    Worker1->>StateStore: Update task 1 state (success)
    Worker3->>StateStore: Update task 3 state (success)

    StateStore->>ParallelTask: All child states complete
    ParallelTask->>ParallelTask: Apply strategy logic
    ParallelTask->>StateStore: Update parent state
    ParallelTask->>Workflow: Return aggregated results`} />

### Execution Components

<List className="mt-8">
  <ListItem title="Temporal Orchestration" icon="GitBranch">
    Distributed workflow engine ensures fault tolerance, automatic retries, and state persistence across system failures
  </ListItem>
  <ListItem title="Dynamic Worker Allocation" icon="Users">
    Intelligent worker pool management with automatic scaling based on max_workers configuration and system resources
  </ListItem>
  <ListItem title="State Management" icon="Database">
    Persistent state tracking for each parallel task with real-time progress monitoring and result aggregation
  </ListItem>
  <ListItem title="Strategy Engine" icon="Settings">
    Configurable execution strategies (wait_all, fail_fast, best_effort, race) with intelligent error handling
  </ListItem>
  <ListItem title="Result Aggregation" icon="BarChart">
    Automatic collection and structuring of outputs accessible via `.tasks.<task-id>.output` template expressions
  </ListItem>
</List>

## Best Practices

<AccordionGroup>
<Accordion title="Strategy Selection Guide" defaultOpen>
<List>
  <ListItem title="Data Aggregation → wait_all" icon="Database">
    When you need all results for downstream processing (user profiles, comprehensive reports, data consolidation)
  </ListItem>
  <ListItem title="Speed Optimization → race" icon="Zap">
    When multiple data sources can provide the same information (cache vs API, primary vs backup services)
  </ListItem>
  <ListItem title="Critical Validation → fail_fast" icon="Shield">
    When any failure invalidates the entire operation (security checks, payment validation, compliance verification)
  </ListItem>
  <ListItem title="Optional Operations → best_effort" icon="CheckCircle">
    When partial success is acceptable (notifications, monitoring, logging, analytics)
  </ListItem>
</List>
</Accordion>

<Accordion title="Performance Optimization" defaultOpen>
<List>
  <ListItem title="Resource-Aware Worker Limits" icon="Cpu">
    CPU-bound: max_workers = CPU cores | I/O-bound: max_workers = 0 (unlimited) | Mixed: max_workers = 6-12
  </ListItem>
  <ListItem title="Intelligent Timeout Configuration" icon="Clock">
    User-facing: 5-30s | Background processing: 5-30m | Critical operations: Match SLA requirements
  </ListItem>
  <ListItem title="Task Independence Design" icon="GitBranch">
    Ensure tasks don't depend on each other's outputs within parallel blocks - use shared workflow inputs instead
  </ListItem>
  <ListItem title="Optimal Task Granularity" icon="Puzzle">
    Balance parallel benefits with coordination overhead - aim for 2-10 meaningful tasks per parallel block
  </ListItem>
</List>
</Accordion>

<Accordion title="Error Handling & Resilience" defaultOpen>
<List>
  <ListItem title="Graceful Degradation" icon="TrendingDown">
    Design workflows to handle partial failures with fallback mechanisms and default values
  </ListItem>
  <ListItem title="Retry Strategy" icon="RotateCcw">
    Configure individual task retries for transient failures before relying on parallel strategy behavior
  </ListItem>
  <ListItem title="Monitoring & Alerting" icon="Bell">
    Implement monitoring for success rates, performance metrics, and resource utilization in production
  </ListItem>
  <ListItem title="Circuit Breaker Pattern" icon="Zap">
    Use race strategy with fallback services to prevent cascading failures from external dependencies
  </ListItem>
</List>
</Accordion>
</AccordionGroup>

## Next Steps

<Tabs items={["Beginners", "Intermediate", "Advanced"]}>
<Tab value="Beginners">

<ReferenceCardList>
  <ReferenceCard
    title="Core Concepts"
    description="Understand fundamental Compozy concepts: agents, tasks, and workflows"
    href="/docs/core/getting-started/core-concepts"
    icon="BookOpen"
  />
  <ReferenceCard
    title="Basic Tasks"
    description="Master the foundation tasks that compose parallel workflows"
    href="/docs/core/tasks/basic-tasks"
    icon="Package"
  />
  <ReferenceCard
    title="First Workflow Tutorial"
    description="Build your first workflow with step-by-step guidance"
    href="/docs/core/getting-started/first-workflow"
    icon="Rocket"
  />
  <ReferenceCard
    title="YAML Templates"
    description="Learn dynamic configuration with template expressions"
    href="/docs/core/yaml-templates/overview"
    icon="FileCode"
  />
</ReferenceCardList>

</Tab>

<Tab value="Intermediate">

<ReferenceCardList>
  <ReferenceCard
    title="Collection Tasks"
    description="Process arrays and lists with parallel execution patterns"
    href="/docs/core/tasks/collection-tasks"
    icon="Grid"
  />
  <ReferenceCard
    title="Aggregate Tasks"
    description="Combine and consolidate results from parallel execution"
    href="/docs/core/tasks/aggregate-tasks"
    icon="BarChart"
  />
  <ReferenceCard
    title="Flow Control"
    description="Implement conditional routing and error handling"
    href="/docs/core/tasks/composite-tasks"
    icon="GitBranch"
  />
  <ReferenceCard
    title="Agent Configuration"
    description="Configure AI agents for optimal parallel performance"
    href="/docs/core/agents/overview"
    icon="BrainCircuit"
  />
</ReferenceCardList>

</Tab>

<Tab value="Advanced">

<ReferenceCardList>
  <ReferenceCard
    title="Advanced Patterns"
    description="Complex workflow orchestration patterns and techniques"
    href="/docs/core/tasks/parallel-processing"
    icon="Layers"
  />
  <ReferenceCard
    title="Signal Coordination"
    description="Coordinate parallel workflows with signals and events"
    href="/docs/core/signals/overview"
    icon="Radio"
  />
  <ReferenceCard
    title="Performance Optimization"
    description="Monitor and optimize parallel workflow performance"
    href="/docs/core/configuration/monitoring"
    icon="BarChart3"
  />
  <ReferenceCard
    title="Production Deployment"
    description="Scale parallel workflows in production environments"
    href="/docs/core/deployment/docker"
    icon="Cloud"
  />
</ReferenceCardList>

</Tab>
</Tabs>
