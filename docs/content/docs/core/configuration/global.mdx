---
title: Global Configuration
description: System-wide configuration and environment settings
---

# Global Configuration

Configure system-wide settings and environment variables for Compozy.

## Overview

**Global Configuration** manages system-wide settings that affect the entire Compozy installation, including:

- **System limits** and performance constraints
- **Database connections** and connection pooling
- **Message queuing** and temporal workflow settings
- **Security settings** and authentication
- **Monitoring and observability** configuration
- **Development vs production** environment settings

<Callout type="info">
  Global configuration is separate from project-specific configuration. These
  settings apply to all projects running on the Compozy instance.
</Callout>

## Configuration Sources

Compozy loads configuration from multiple sources with the following precedence (highest to lowest):

1. **CLI flags** (highest priority)
2. **YAML configuration file**
3. **Environment variables**
4. **Default values** (lowest priority)

## Configuration File

### Location

The global configuration file is typically located at:

```bash
# Default locations (in order of preference)
./compozy-config.yaml
~/.config/compozy/config.yaml
/etc/compozy/config.yaml
```

### Basic Configuration

```yaml
# compozy-config.yaml
server:
  host: "0.0.0.0"
  port: 8080
  cors_enabled: true
  timeout: 30s

database:
  host: "localhost"
  port: "5432"
  user: "compozy"
  password: "secure_password"
  name: "compozy_db"
  ssl_mode: "require"

temporal:
  host_port: "localhost:7233"
  namespace: "compozy"
  task_queue: "compozy-tasks"

runtime:
  environment: "production"
  log_level: "info"
  dispatcher_heartbeat_interval: 30s
  dispatcher_heartbeat_ttl: 300s
  dispatcher_stale_threshold: 120s

limits:
  max_nesting_depth: 20
  max_string_length: 10485760 # 10MB
  max_message_content: 10240 # 10KB
  max_total_content_size: 102400 # 100KB
  max_task_context_depth: 10
  parent_update_batch_size: 100
```

### Complete Configuration

<Tabs items={['Production', 'Development', 'Docker']}>
  <Tab value="Production">
```yaml
# Production configuration
server:
  host: "0.0.0.0"
  port: 8080
  cors_enabled: false
  timeout: 30s

database:
conn_string: "postgresql://compozy:${DB_PASSWORD}@db.example.com:5432/compozy_prod?sslmode=require"

temporal:
host_port: "temporal.example.com:7233"
namespace: "compozy-prod"
task_queue: "compozy-prod-tasks"

runtime:
environment: "production"
log_level: "info"
dispatcher_heartbeat_interval: 30s
dispatcher_heartbeat_ttl: 300s
dispatcher_stale_threshold: 120s
async_token_counter_workers: 20
async_token_counter_buffer_size: 2000

limits:
max_nesting_depth: 20
max_string_length: 52428800 # 50MB
max_message_content: 10240
max_total_content_size: 1048576 # 1MB
max_task_context_depth: 15
parent_update_batch_size: 200

openai:
api_key: "${OPENAI_API_KEY}"
base_url: "https://api.openai.com/v1"
default_model: "gpt-4"

memory:
redis_url: "redis://redis.example.com:6379/0"
redis_prefix: "compozy:prod:"
ttl: 24h
max_entries: 10000

llm:
proxy_url: "http://mcp-proxy:8081"
admin_token: "${MCP_ADMIN_TOKEN}"

````
  </Tab>
  <Tab value="Development">
```yaml
# Development configuration
server:
  host: "localhost"
  port: 8080
  cors_enabled: true
  timeout: 60s

database:
  host: "localhost"
  port: "5432"
  user: "compozy_dev"
  password: "dev_password"
  name: "compozy_dev"
  ssl_mode: "disable"

temporal:
  host_port: "localhost:7233"
  namespace: "compozy-dev"
  task_queue: "compozy-dev-tasks"

runtime:
  environment: "development"
  log_level: "debug"
  dispatcher_heartbeat_interval: 10s
  dispatcher_heartbeat_ttl: 60s
  dispatcher_stale_threshold: 30s
  async_token_counter_workers: 5
  async_token_counter_buffer_size: 100

limits:
  max_nesting_depth: 10
  max_string_length: 1048576  # 1MB
  max_message_content: 10240
  max_total_content_size: 102400
  max_task_context_depth: 5
  parent_update_batch_size: 50

memory:
  redis_url: "redis://localhost:6379/1"
  redis_prefix: "compozy:dev:"
  ttl: 1h
  max_entries: 1000

llm:
  proxy_url: "http://localhost:8081"
  admin_token: "dev_admin_token"
````

  </Tab>
  <Tab value="Docker">
```yaml
# Docker configuration
server:
  host: "0.0.0.0"
  port: 8080
  cors_enabled: true
  timeout: 30s

database:
conn_string: "postgresql://compozy:${DB_PASSWORD}@postgres:5432/compozy?sslmode=disable"

temporal:
host_port: "temporal:7233"
namespace: "compozy"
task_queue: "compozy-tasks"

runtime:
environment: "docker"
log_level: "info"
dispatcher_heartbeat_interval: 30s
dispatcher_heartbeat_ttl: 300s
dispatcher_stale_threshold: 120s

limits:
max_nesting_depth: 20
max_string_length: 10485760
max_message_content: 10240
max_total_content_size: 102400
max_task_context_depth: 10
parent_update_batch_size: 100

memory:
redis_url: "redis://redis:6379/0"
redis_prefix: "compozy:"
ttl: 24h
max_entries: 5000

llm:
proxy_url: "http://mcp-proxy:8081"
admin_token: "${MCP_ADMIN_TOKEN}"

````
  </Tab>
</Tabs>

## Environment Variables

### Core Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `SERVER_HOST` | Server bind address | `localhost` |
| `SERVER_PORT` | Server port | `8080` |
| `SERVER_CORS_ENABLED` | Enable CORS | `true` |
| `SERVER_TIMEOUT` | Request timeout | `30s` |

### Database Configuration

| Variable | Description | Example |
|----------|-------------|---------|
| `DB_CONN_STRING` | Complete connection string | `postgresql://user:pass@host:5432/db` |
| `DB_HOST` | Database host | `localhost` |
| `DB_PORT` | Database port | `5432` |
| `DB_USER` | Database user | `compozy` |
| `DB_PASSWORD` | Database password | `secure_password` |
| `DB_NAME` | Database name | `compozy_db` |
| `DB_SSL_MODE` | SSL mode | `require` |

### Temporal Configuration

| Variable | Description | Example |
|----------|-------------|---------|
| `TEMPORAL_HOST_PORT` | Temporal server address | `localhost:7233` |
| `TEMPORAL_NAMESPACE` | Temporal namespace | `compozy` |
| `TEMPORAL_TASK_QUEUE` | Task queue name | `compozy-tasks` |

### Runtime Configuration

| Variable | Description | Values |
|----------|-------------|---------|
| `RUNTIME_ENVIRONMENT` | Environment type | `development`, `staging`, `production` |
| `RUNTIME_LOG_LEVEL` | Log level | `debug`, `info`, `warn`, `error` |
| `RUNTIME_DISPATCHER_HEARTBEAT_INTERVAL` | Heartbeat interval | `30s` |
| `RUNTIME_DISPATCHER_HEARTBEAT_TTL` | Heartbeat TTL | `300s` |
| `RUNTIME_DISPATCHER_STALE_THRESHOLD` | Stale threshold | `120s` |
| `RUNTIME_ASYNC_TOKEN_COUNTER_WORKERS` | Token counter workers | `10` |
| `RUNTIME_ASYNC_TOKEN_COUNTER_BUFFER_SIZE` | Buffer size | `1000` |

### System Limits

| Variable | Description | Default |
|----------|-------------|---------|
| `LIMITS_MAX_NESTING_DEPTH` | Maximum nesting depth | `20` |
| `LIMITS_MAX_STRING_LENGTH` | Maximum string length | `10485760` |
| `LIMITS_MAX_MESSAGE_CONTENT_LENGTH` | Maximum message content | `10240` |
| `LIMITS_MAX_TOTAL_CONTENT_SIZE` | Maximum total content | `102400` |
| `LIMITS_MAX_TASK_CONTEXT_DEPTH` | Maximum task context depth | `10` |
| `LIMITS_PARENT_UPDATE_BATCH_SIZE` | Batch size for updates | `100` |

### LLM Provider Configuration

| Variable | Description | Example |
|----------|-------------|---------|
| `OPENAI_API_KEY` | OpenAI API key | `sk-...` |
| `OPENAI_BASE_URL` | OpenAI base URL | `https://api.openai.com/v1` |
| `OPENAI_ORG_ID` | OpenAI organization ID | `org-...` |
| `OPENAI_DEFAULT_MODEL` | Default OpenAI model | `gpt-4` |

### Memory Configuration

| Variable | Description | Example |
|----------|-------------|---------|
| `MEMORY_REDIS_URL` | Redis connection URL | `redis://localhost:6379/0` |
| `MEMORY_REDIS_PREFIX` | Redis key prefix | `compozy:` |
| `MEMORY_TTL` | Memory TTL | `24h` |
| `MEMORY_MAX_ENTRIES` | Maximum entries | `10000` |

### MCP Configuration

| Variable | Description | Example |
|----------|-------------|---------|
| `MCP_PROXY_URL` | MCP proxy URL | `http://localhost:8081` |
| `MCP_ADMIN_TOKEN` | MCP admin token | `secure_token` |

## CLI Configuration

### Show Configuration

Display current configuration with source information:

```bash
# Show configuration in table format
compozy config show

# Show configuration with sources
compozy config show --sources

# Show in JSON format
compozy config show --format json

# Show in YAML format
compozy config show --format yaml
````

### Validate Configuration

Validate configuration files:

```bash
# Validate default configuration
compozy config validate

# Validate specific configuration file
compozy config validate --config /path/to/config.yaml

# Validate with environment file
compozy config validate --env-file .env.production
```

### Configuration Diagnostics

Run comprehensive configuration diagnostics:

```bash
# Basic diagnostics
compozy config diagnostics

# Verbose diagnostics
compozy config diagnostics --verbose

# Check specific environment
compozy config diagnostics --env-file .env.production
```

## System Limits

### Performance Limits

Configure system performance limits:

```yaml
limits:
  # Template processing limits
  max_nesting_depth: 20 # Maximum template nesting
  max_string_length: 10485760 # 10MB string limit

  # Message processing limits
  max_message_content: 10240 # 10KB per message
  max_total_content_size: 102400 # 100KB total

  # Task execution limits
  max_task_context_depth: 10 # Task context depth
  parent_update_batch_size: 100 # Batch size for updates
```

### Resource Limits

Configure resource consumption limits:

```yaml
runtime:
  # Worker configuration
  async_token_counter_workers: 10 # Token counting workers
  async_token_counter_buffer_size: 1000 # Buffer size

  # Dispatcher configuration
  dispatcher_heartbeat_interval: 30s # Heartbeat frequency
  dispatcher_heartbeat_ttl: 300s # Heartbeat TTL
  dispatcher_stale_threshold: 120s # Stale detection
```

## Database Configuration

### Connection String

Use a complete connection string:

```yaml
database:
  conn_string: "postgresql://user:password@host:5432/database?sslmode=require&connect_timeout=10"
```

### Individual Parameters

Or configure individual parameters:

```yaml
database:
  host: "localhost"
  port: "5432"
  user: "compozy"
  password: "secure_password"
  name: "compozy_db"
  ssl_mode: "require"
```

### Connection Pooling

Configure connection pooling (if supported):

```yaml
database:
  conn_string: "postgresql://user:password@host:5432/database"
  pool_size: 20
  max_idle_conns: 10
  max_open_conns: 100
  conn_max_lifetime: 1h
```

## Temporal Configuration

### Basic Configuration

```yaml
temporal:
  host_port: "localhost:7233"
  namespace: "compozy"
  task_queue: "compozy-tasks"
```

### Advanced Configuration

```yaml
temporal:
  host_port: "temporal.example.com:7233"
  namespace: "compozy-prod"
  task_queue: "compozy-prod-tasks"

  # TLS configuration
  tls_cert_path: "/path/to/client.crt"
  tls_key_path: "/path/to/client.key"
  tls_ca_path: "/path/to/ca.crt"
  tls_server_name: "temporal.example.com"

  # Client configuration
  connection_timeout: 30s
  keep_alive_time: 30s
  keep_alive_timeout: 5s
```

## Environment-Specific Configuration

### Development Environment

```yaml
runtime:
  environment: "development"
  log_level: "debug"

server:
  cors_enabled: true
  timeout: 60s

database:
  ssl_mode: "disable"

limits:
  max_nesting_depth: 10
  max_string_length: 1048576 # 1MB for development
```

### Production Environment

```yaml
runtime:
  environment: "production"
  log_level: "info"

server:
  cors_enabled: false
  timeout: 30s

database:
  ssl_mode: "require"

limits:
  max_nesting_depth: 20
  max_string_length: 52428800 # 50MB for production
```

## Security Configuration

### API Keys and Secrets

Store sensitive values in environment variables:

```yaml
openai:
  api_key: "${OPENAI_API_KEY}"

database:
  password: "${DB_PASSWORD}"

llm:
  admin_token: "${MCP_ADMIN_TOKEN}"
```

### TLS Configuration

Configure TLS for secure connections:

```yaml
server:
  tls_enabled: true
  tls_cert_path: "/path/to/server.crt"
  tls_key_path: "/path/to/server.key"

temporal:
  tls_enabled: true
  tls_cert_path: "/path/to/client.crt"
  tls_key_path: "/path/to/client.key"
  tls_ca_path: "/path/to/ca.crt"
```

## Monitoring Configuration

### Basic Monitoring

```yaml
monitoring:
  enabled: true
  path: "/metrics"
```

### Advanced Monitoring

```yaml
monitoring:
  enabled: true
  path: "/metrics"

  # Metrics configuration
  metrics:
    enabled: true
    provider: "prometheus"
    interval: 30s

  # Health checks
  health:
    enabled: true
    path: "/health"
    interval: 10s

  # Logging configuration
  logging:
    structured: true
    level: "info"
    format: "json"
```

## Configuration Management

### Configuration Files

Use different configuration files for different environments:

```bash
# Development
compozy server --config config/development.yaml

# Staging
compozy server --config config/staging.yaml

# Production
compozy server --config config/production.yaml
```

### Environment Variables

Override configuration with environment variables:

```bash
# Override server port
SERVER_PORT=9090 compozy server

# Override database connection
DB_CONN_STRING="postgresql://..." compozy server

# Override log level
RUNTIME_LOG_LEVEL=debug compozy server
```

### Configuration Validation

Validate configuration before deployment:

```bash
# Validate configuration
compozy config validate --config config/production.yaml

# Test database connection
compozy config test-db --config config/production.yaml

# Test Temporal connection
compozy config test-temporal --config config/production.yaml
```

## Best Practices

### Security

1. **Environment Variables**: Use environment variables for sensitive data
2. **TLS**: Enable TLS for production environments
3. **Access Control**: Implement proper access controls
4. **Secrets Management**: Use dedicated secrets management systems

### Performance

1. **Connection Pooling**: Configure appropriate connection pool sizes
2. **Resource Limits**: Set appropriate resource limits
3. **Monitoring**: Enable monitoring and alerting
4. **Caching**: Use Redis for caching when appropriate

### Reliability

1. **Health Checks**: Implement comprehensive health checks
2. **Timeouts**: Set appropriate timeouts
3. **Error Handling**: Configure proper error handling
4. **Backup**: Implement backup strategies

### Development

1. **Environment Separation**: Use different configs for different environments
2. **Validation**: Validate configuration changes
3. **Testing**: Test configuration changes thoroughly
4. **Documentation**: Document configuration changes

## Troubleshooting

### Common Issues

<Callout type="error">
  **Database Connection Failed**: Check database configuration and connectivity
  ```bash # Test database connection compozy config test-db ```
</Callout>

<Callout type="error">
  **Temporal Connection Failed**: Check Temporal server and configuration
  ```bash # Test Temporal connection compozy config test-temporal ```
</Callout>

<Callout type="error">
  **Configuration Validation Failed**: Check configuration syntax and values
  ```bash # Validate configuration compozy config validate --verbose ```
</Callout>

### Debug Commands

```bash
# Show effective configuration
compozy config show --sources

# Run diagnostics
compozy config diagnostics --verbose

# Test connections
compozy config test-all

# Check environment variables
compozy config env
```

## Next Steps

- Learn about [CLI Configuration](/docs/core/configuration/cli)
- Set up [Monitoring](/docs/core/configuration/monitoring-config)
- Configure [Project Setup](/docs/core/configuration/project-setup)
- Explore [Runtime Configuration](/docs/core/configuration/runtime-config)
