---
title: Workflow
description: Configure workflow-level settings including inputs, outputs, triggers, scheduling, and environment variables in Compozy
---

## Overview

Workflows are the core building blocks of Compozy that orchestrate the execution of AI agents, tools, and tasks. They provide a declarative way to define complex AI-powered applications through YAML configuration. Each workflow can include input validation, environment configuration, event triggers, automated scheduling, and output transformation.

If you're new to Compozy workflows, start with the [Quick Start Guide](/docs/core/getting-started/quick-start) for a 5-minute introduction, or dive deeper with the [First Workflow Tutorial](/docs/core/getting-started/first-workflow) to build a complete AI-powered application.

This page covers workflow configuration in detail. For workflow execution, see the [Workflow Commands](/docs/cli/workflow-commands) or [Workflow API](/docs/api/workflows).

<Callout type="info">
  For the complete workflow schema reference with all available properties, see the [Workflow Schema documentation](/docs/schema/workflows).
</Callout>

## Basic Structure

Every workflow starts with essential metadata that identifies and describes its purpose. Workflows are typically stored in your [project directory](/docs/core/configuration/project-setup) as `workflow.yaml` files or in a `workflows/` folder for multiple workflows.

```yaml
id: my-workflow
version: "1.0.0"
description: "Workflow purpose and description"
author:
  name: "Your Name"
  email: "your.email@example.com"
```

The workflow ID must be unique within your project and is used when executing workflows via CLI or [API](/docs/api/workflows). Version tracking helps manage workflow evolution over time.

## Configuration Options

Workflow configuration controls how your workflow behaves at runtime. These settings define input validation rules, environment variables, and other execution parameters. All configuration options are defined under the `config` key in your workflow YAML.

### Input Validation

Compozy uses [JSON Schema](https://json-schema.org/) to validate workflow inputs, ensuring data integrity before execution begins. This prevents errors and provides clear feedback when inputs don't match expected formats.

```yaml
config:
  input:
    type: object
    properties:
      message:
        type: string
        minLength: 10
      priority:
        type: string
        enum: [low, medium, high]
    required: [message]
```

For reusable validation, reference [schemas](#schema-definitions) using Compozy's `$ref` [directive](/docs/core/yaml-templates/directives):

```yaml
config:
  input:
    $ref: "local::schemas.#(id==\"user_input\")"
```

Input validation errors are returned when executing workflows, helping developers quickly identify and fix issues.

### Environment Variables

Configure runtime environment variables for your workflows, tools, and agents. Variables can be set at multiple levels following Compozy's [configuration precedence](/docs/core/configuration/global).

```yaml
config:
  env:
    API_URL: "https://api.example.com"
    API_KEY: "{{ .env.EXTERNAL_API_KEY }}"
    SECRET: "{{ .secrets.API_SECRET }}"
```

Environment variables are injected into:
- [Tool runtime environments](/docs/core/tools/runtime-environment) with controlled permissions
- [Agent configurations](/docs/core/agents/overview) for API keys and settings
- Task execution contexts via [template variables](/docs/core/yaml-templates/context-variables)

For sensitive data, follow [security best practices](/docs/core/memory/privacy-security) and use the secrets system. Configure environment variables in your [project setup](/docs/core/configuration/project-setup) or [global configuration](/docs/core/configuration/global).

## Triggers

Triggers enable workflows to automatically start when specific events occur in your system. The most common trigger type is `signal`, which creates a publish-subscribe pattern where workflows react to named events.

```yaml
triggers:
  - type: signal
    name: user-registration
    schema:
      type: object
      properties:
        userId:
          type: string
        email:
          type: string
          format: email
      required: [userId, email]
```

When a signal is sent (either through the [Event API](/docs/core/signals/event-api) or from a [Signal Task](/docs/core/signals/signal-tasks)), any workflow listening for that signal name will automatically start with the signal payload as input.

<Callout type="tip">
  To learn more about Compozy's signal system and event-driven patterns, see the [Signal System Overview](/docs/core/signals/overview) and [Signal Triggers](/docs/core/signals/signal-triggers) documentation.
</Callout>

## Scheduling

Schedule workflows to run automatically at specific times using cron expressions. Compozy leverages Temporal's scheduling engine to provide reliable, distributed scheduling with timezone support and overlap handling.

```yaml
schedule:
  cron: "0 9 * * *"  # Daily at 9 AM
  timezone: "America/New_York"
  overlap_policy: skip  # skip, allow, buffer_one, cancel_other
  input:
    mode: "scheduled"
```

The `overlap_policy` controls behavior when a scheduled run starts before the previous one completes:
- `skip` - Skip the overlapping run
- `allow` - Run in parallel
- `buffer_one` - Queue one run
- `cancel_other` - Cancel the previous run

<Callout type="info">
  Manage schedules at runtime using the [Schedules API](/docs/api/schedules). You can enable/disable schedules, update cron expressions, and monitor execution status without modifying YAML files.
</Callout>

## Schema Definitions

Define reusable JSON Schema validators within your workflow to ensure consistent data validation across inputs, outputs, and intermediate data structures.

```yaml
schemas:
  - id: customer_data
    type: object
    properties:
      email:
        type: string
        format: email
      name:
        type: string
    required: [email, name]
```

Reference schemas using Compozy's `$ref` syntax:

```yaml
config:
  input:
    $ref: "local::schemas.#(id==\"customer_data\")"
```

Schemas integrate with the broader [YAML Template System](/docs/core/yaml-templates/overview) and support all JSON Schema features. Learn more about [reference patterns](/docs/core/yaml-templates/directives).

## MCP Servers

Configure Model Context Protocol (MCP) servers to extend your AI agents with external tools and integrations. MCP provides a standardized way for agents to interact with databases, APIs, file systems, and custom tools.

```yaml
mcps:
  - id: knowledge-base
    url: "http://localhost:8080/mcp"
    proto: "2025-03-26"
    env:
      API_KEY: "{{ .secrets.MCP_KEY }}"
```

MCP servers connect through Compozy's [MCP Proxy Server](/docs/core/mcp/mcp-proxy-server) (port 6001) which handles authentication, connection management, and protocol translation. Learn about [MCP integration patterns](/docs/core/mcp/integration-patterns) and [transport configuration](/docs/core/mcp/transport-configuration).

<Callout type="tip">
  Discover available MCP tools at runtime using the [Admin API](/docs/core/mcp/admin-api) or configure tool discovery for dynamic tool loading.
</Callout>

## Outputs

Define the structure and content of data returned when a workflow completes. Outputs use template expressions to aggregate and transform results from tasks, making it easy to create API-friendly response structures.

```yaml
outputs:
  workflow_id: "{{ .workflow.id }}"
  result: "{{ .tasks.process.output }}"
  status: "{{ .tasks.validate.output.valid ? 'success' : 'failed' }}"
```

Access data through [template variables](/docs/core/yaml-templates/context-variables):
- Task outputs: `{{ .tasks.TASK_ID.output }}`
- Workflow metadata: `{{ .workflow.id }}`, `{{ .workflow.runId }}`
- Conditional logic: Ternary operators and [Sprig functions](/docs/core/yaml-templates/sprig-functions)

For advanced output patterns, see [Template Advanced Patterns](/docs/core/yaml-templates/overview).

## Complete Workflow Examples

<ReferenceCardList>
  <ReferenceCard
    title="Quick Start Guide"
    description="Build a simple greeting workflow in 5 minutes to understand basic workflow structure"
    href="/docs/core/getting-started/quick-start"
    icon="Rocket"
  />
  <ReferenceCard
    title="First Workflow Tutorial"
    description="Create an advanced Go code analyzer with parallel tasks, AI agents, and file operations"
    href="/docs/core/getting-started/first-workflow"
    icon="GraduationCap"
  />
  <ReferenceCard
    title="Task Configuration Examples"
    description="Explore various task patterns including basic, parallel, collection, and router tasks"
    href="/docs/core/tasks/basic-tasks"
    icon="Layers"
  />
</ReferenceCardList>

## Related Documentation

<ReferenceCardList>
  <ReferenceCard
    title="Signal System"
    description="Build event-driven workflows with signals and triggers"
    href="/docs/core/signals/overview"
    icon="Radio"
  />
  <ReferenceCard
    title="Basic Tasks"
    description="Configure the tasks that execute within your workflows"
    href="/docs/core/tasks/basic-tasks"
    icon="Package"
  />
  <ReferenceCard
    title="MCP Overview"
    description="Extend agents with external tools through MCP servers"
    href="/docs/core/mcp/overview"
    icon="Cpu"
  />
  <ReferenceCard
    title="YAML Templates"
    description="Master template expressions, variables, and functions"
    href="/docs/core/yaml-templates/overview"
    icon="Code"
  />
  <ReferenceCard
    title="Schedules API"
    description="Manage workflow schedules programmatically"
    href="/docs/api/schedules"
    icon="Clock"
  />
  <ReferenceCard
    title="Workflow Schema"
    description="Complete property reference for workflow configuration"
    href="/docs/schema/workflows"
    icon="FileCode"
  />
</ReferenceCardList>
