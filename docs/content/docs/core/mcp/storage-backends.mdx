---
title: "Storage Backends"
description: "Configure MCP proxy storage backends for persisting MCP server definitions and status information"
---

The MCP Proxy uses simple storage backends to persist MCP server definitions and their connection status. This guide covers the two available storage options and their basic configuration.

## Available Storage Types

The MCP Proxy supports two storage backends:

<FeatureCardList cols={2} size="sm" className="mb-8">
  <FeatureCard
    title="In-Memory Storage"
    description="Fast access with automatic cleanup. Best for development and testing."
    icon="brain"
    badge="Development"
  />
  <FeatureCard
    title="Redis Storage"
    description="Persistent storage using Redis. Recommended for production environments."
    icon="Server"
    badge="Production"
  />
</FeatureCardList>

## Storage Interface

All storage backends implement the same basic interface for MCP server management:

```go
type Storage interface {
    SaveMCP(ctx context.Context, def *MCPDefinition) error
    LoadMCP(ctx context.Context, name string) (*MCPDefinition, error)
    DeleteMCP(ctx context.Context, name string) error
    ListMCPs(ctx context.Context) ([]*MCPDefinition, error)
    SaveStatus(ctx context.Context, status *MCPStatus) error
    LoadStatus(ctx context.Context, name string) (*MCPStatus, error)
    Close() error
}
```

This interface provides basic CRUD operations for MCP definitions and status tracking.

## Storage Selection Guide

<Tabs items={["Development", "Production"]}>
<Tab>
<Card className="mb-6">
  <CardHeader>
    <CardTitle className="flex items-center gap-2">
      <Icon name="code" className="h-5 w-5" />
      Development Environment
    </CardTitle>
  </CardHeader>
  <CardContent>
    <div className="space-y-4">
      <div className="flex items-center gap-2">
        <Badge>Recommended</Badge>
        <span className="font-medium">In-Memory Storage</span>
      </div>
      <p className="text-sm text-muted-foreground">
        Fast iteration cycles, automatic cleanup, and minimal configuration overhead.
        Perfect for local development and testing scenarios.
      </p>
      <div className="grid grid-cols-2 gap-4 text-sm">
        <div>
          <strong>Pros:</strong>
          <ul className="list-disc list-inside mt-1 space-y-1">
            <li>Fastest performance</li>
            <li>Zero configuration</li>
            <li>Automatic cleanup</li>
            <li>No external dependencies</li>
          </ul>
        </div>
        <div>
          <strong>Cons:</strong>
          <ul className="list-disc list-inside mt-1 space-y-1">
            <li>Data loss on restart</li>
            <li>Memory limitations</li>
            <li>No persistence</li>
            <li>Single instance only</li>
          </ul>
        </div>
      </div>
    </div>
  </CardContent>
</Card>
</Tab>

<Tab>
<Card className="mb-6">
  <CardHeader>
    <CardTitle className="flex items-center gap-2">
      <Icon name="cloud" className="h-5 w-5" />
      Production Environment
    </CardTitle>
  </CardHeader>
  <CardContent>
    <div className="space-y-4">
      <div className="flex items-center gap-2">
        <Badge>Recommended</Badge>
        <span className="font-medium">Redis Storage</span>
      </div>
      <p className="text-sm text-muted-foreground">
        Persistent storage with Redis for production workloads.
        Provides data persistence and better performance than in-memory for production use.
      </p>
      <div className="grid grid-cols-2 gap-4 text-sm">
        <div>
          <strong>Pros:</strong>
          <ul className="list-disc list-inside mt-1 space-y-1">
            <li>Data persistence</li>
            <li>Good performance</li>
            <li>Proven reliability</li>
            <li>Simple configuration</li>
          </ul>
        </div>
        <div>
          <strong>Cons:</strong>
          <ul className="list-disc list-inside mt-1 space-y-1">
            <li>External dependency</li>
            <li>Memory-based limits</li>
            <li>Network latency</li>
            <li>Requires Redis server</li>
          </ul>
        </div>
      </div>
    </div>
  </CardContent>
</Card>
</Tab>
</Tabs>

## In-Memory Storage

In-memory storage is the simplest option for development and testing. It stores all MCP definitions and status information in memory with thread-safe access.

### Configuration

In-memory storage requires no configuration and is created automatically when specified:

```go
// Create in-memory storage
storage := NewMemoryStorage()
```

### Features

- **Thread-safe**: Uses mutex protection for concurrent access
- **Automatic cleanup**: Data is automatically cleared when the process stops
- **No persistence**: Data is lost when the service restarts
- **Zero configuration**: No setup required

### Usage Example

```go
// Create storage
storage := NewMemoryStorage()

// Save MCP definition
def := &MCPDefinition{
    Name:      "test-mcp",
    Transport: TransportSSE,
    URL:       "http://localhost:3000",
}
err := storage.SaveMCP(ctx, def)

// Load MCP definition
loaded, err := storage.LoadMCP(ctx, "test-mcp")
```

## Redis Storage

Redis storage provides persistent storage for production environments. It uses a Redis server to store MCP definitions and status information.

### Configuration

Configure Redis storage with connection details:

```go
// Redis configuration
config := &RedisConfig{
    Addr:         "localhost:6379",
    Password:     "",
    DB:           0,
    PoolSize:     10,
    MinIdleConns: 2,
    MaxRetries:   3,
    DialTimeout:  5 * time.Second,
    ReadTimeout:  3 * time.Second,
    WriteTimeout: 3 * time.Second,
}

// Create Redis storage
storage, err := NewRedisStorage(config)
```

### Environment Variables

You can configure Redis using environment variables:

```bash
export REDIS_ADDR=localhost:6379
export REDIS_PASSWORD=your-password
export REDIS_DB=0
```

### Features

- **Persistent storage**: Data survives service restarts
- **Connection pooling**: Efficient connection management
- **Automatic reconnection**: Handles network failures gracefully
- **Key namespacing**: Prevents key conflicts with other applications

### Usage Example

```go
// Create Redis storage
config := DefaultRedisConfig()
storage, err := NewRedisStorage(config)
if err != nil {
    log.Fatal("Failed to create Redis storage:", err)
}

// Save MCP definition
def := &MCPDefinition{
    Name:      "prod-mcp",
    Transport: TransportSSE,
    URL:       "https://api.example.com/mcp",
}
err = storage.SaveMCP(ctx, def)

// List all MCPs
mcps, err := storage.ListMCPs(ctx)
```

## Storage Factory

The storage factory provides a convenient way to create storage instances based on configuration:

```go
// Storage configuration
config := &StorageConfig{
    Type:  StorageTypeRedis,
    Redis: DefaultRedisConfig(),
}

// Create storage
storage, err := NewStorage(config)
```

### Configuration Options

```go
type StorageConfig struct {
    Type  StorageType  `json:"type"`
    Redis *RedisConfig `json:"redis,omitempty"`
}

// Available storage types
const (
    StorageTypeRedis  StorageType = "redis"
    StorageTypeMemory StorageType = "memory"
)
```

## Best Practices

### Development

- Use in-memory storage for development and testing
- No configuration required
- Fast iteration cycles
- Automatic cleanup

### Production

- Use Redis storage for production environments
- Configure connection pooling appropriately
- Monitor Redis memory usage
- Consider Redis persistence settings
- Use authentication for security

### Error Handling

Always handle storage errors appropriately:

```go
// Check for specific error types
if err != nil {
    if strings.Contains(err.Error(), "not found") {
        // Handle missing MCP
        return nil, fmt.Errorf("MCP not found: %w", err)
    }
    // Handle other errors
    return nil, fmt.Errorf("storage error: %w", err)
}
```

## Monitoring

Monitor storage health and performance:

```go
// Check Redis connection health
err := storage.(*RedisStorage).Ping(ctx)
if err != nil {
    log.Error("Redis health check failed", "error", err)
}

// Get Redis statistics
stats := storage.(*RedisStorage).Stats()
log.Info("Redis stats", "stats", stats)
```

## Next Steps

<ReferenceCardList>
  <ReferenceCard
    title="Tool Discovery"
    description="Learn how tools are discovered and registered from MCP servers"
    href="/docs/core/mcp/tool-discovery"
    icon="Search"
  />
  <ReferenceCard
    title="Client Manager"
    description="Manage MCP client connections and lifecycle"
    href="/docs/core/mcp/client-manager"
    icon="Network"
  />
  <ReferenceCard
    title="Production Deployment"
    description="Deploy MCP proxy in production environments"
    href="/docs/core/mcp/production-deployment"
    icon="Cloud"
  />
</ReferenceCardList>