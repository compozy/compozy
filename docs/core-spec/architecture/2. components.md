# Component Naming Standardization

This document outlines the standardized architectural component names within the Compozy Workflow Engine project. These names align with widely recognized terminology in distributed systems and workflow management, enhancing clarity and maintainability.

## Component Names

1. **API Service**

   - **Package:** `api_service`
   - **Struct:** `APIService`
   - **Responsibilities:**
     - Exposes external APIs (REST or gRPC) for managing and interacting with the workflow engine.
     - Handles endpoints for creating, updating, and deleting workflow definitions.
     - Facilitates triggering new workflow instances and querying their status and history.
     - Supports manual interventions like retrying failed steps or canceling workflows.

2. **Workflow Definition Manager**

   - **Package:** `definition_manager`
   - **Struct:** `WorkflowDefinitionManager`
   - **Responsibilities:**
     - Manages the lifecycle of workflow definitions.
     - Parses and validates workflow blueprints defined in Go DSL or YAML/JSON formats.
     - Stores and versions workflow definitions in a persistence layer or version control system.

3. **Workflow Orchestrator**

   - **Package:** `orchestrator`
   - **Struct:** `WorkflowOrchestrator`
   - **Responsibilities:**
     - Acts as the central brain of the engine, initiating workflow executions based on triggers.
     - Interprets workflow definitions to manage sequence, conditional logic, and parallelism.
     - Maintains the high-level state of running workflow instances.
     - Coordinates with other components to dispatch tasks and update states.

4. **Workflow State Manager**

   - **Package:** `workflow_state`
   - **Struct:** `WorkflowStateManager`
   - **Responsibilities:**
     - Manages persistence and retrieval of all workflow-related state data.
     - Implements event sourcing by recording state changes as immutable events in NATS JetStream.
     - Takes periodic snapshots of workflow instances for efficient state reconstruction.
     - Provides APIs for recording events and querying current or historical states.

5. **Task Dispatcher**

   - **Package:** `task_dispatcher`
   - **Struct:** `TaskDispatcher`
   - **Responsibilities:**
     - Receives task execution requests from the Workflow Orchestrator.
     - Places tasks onto appropriate NATS subjects (task queues) for Task Executors.
     - Manages scheduled tasks or delayed executions for timeouts and retries.

6. **Task Executor**

   - **Package:** `task_executor`
   - **Struct:** `TaskExecutor`
   - **Responsibilities:**
     - Operates as a pool of workers subscribing to NATS task queues.
     - Executes task logic, including Go-native code or invoking tools via NATS to Deno runtime.
     - Reports task outcomes (success, failure, output) back to the Workflow Orchestrator.

7. **Agent Dispatcher**

   - **Package:** `agent`
   - **Struct:** `Dispatcher`
   - **Responsibilities:**
     - Receives agent execution requests from Task Executors.
     - Manages the routing of agent requests to the appropriate runtime environment.
     - Handles agent execution scheduling and prioritization.
     - Tracks agent availability and load balancing across runtime instances.

8. **Agent Runtime**

   - **Package:** `agent`
   - **Struct:** `agent.Runtime`
   - **Responsibilities:**
     - Provides the execution environment for AI agents (typically Deno runtime).
     - Manages agent lifecycle including initialization, execution, and cleanup.
     - Handles agent context and state management during interactions.
     - Communicates agent results back to the Task Executor or Agent Dispatcher.

9. **Tool Dispatcher**

   - **Package:** `tool`
   - **Struct:** `Dispatcher`
   - **Responsibilities:**
     - Receives tool execution requests from agents or Task Executors.
     - Routes tool requests to appropriate tool implementations.
     - Manages tool registration and discovery.
     - Handles tool execution prioritization and rate limiting.

10. **Tool Executor**

    - **Package:** `tool`
    - **Struct:** `Executor`
    - **Responsibilities:**
      - Executes specific tool implementations when requested.
      - Manages tool-specific configurations and dependencies.
      - Validates tool inputs and formats outputs according to schemas.
      - Reports tool execution results back to the requesting agent or task.

11. **NATS Client**
    - **Package:** `nats_client`
    - **Struct:** `NATSClient`
    - **Responsibilities:**
      - Facilitates all asynchronous communication between workflow engine components.
      - Supports task queues, event streams, and inter-process communication with Deno runtime.
      - Enables streaming for real-time updates and chat-style interactions.
      - Ensures durability with JetStream for critical message streams.

## Impact

These standardized names are reflected in:

- Directory structures within `src/internal/`.
- Go package declarations and struct definitions.
- Import paths and instantiation points throughout the codebase.
- References in documentation files (READMEs, architecture diagrams, task definitions, assertion scenarios, etc.).

This standardization improves the project's alignment with industry best practices and makes the codebase more intuitive for developers familiar with distributed systems and workflow engine concepts.
