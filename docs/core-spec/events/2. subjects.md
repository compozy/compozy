## NATS Subject Naming Conventions

Compozy uses distinct subject naming patterns that correspond to message types (State Events, Commands, Command Results).

#### 1. State Event Subjects
Used for events that record state changes for event sourcing.

Pattern: `compozy.<correlation_id>.<entity>.events.<identifier>.<event_type>`

Where:
-   `<entity>`: "workflow", "task", "agent", "tool"
-   `<identifier>`: ID of the entity instance (e.g., `workflow_exec_id`, `task_exec_id`, `agent_exec_id`, `tool_exec_id`, `runtime_id` for agent runtime)
-   `<event_type>`: Specific event name (e.g., "started", "success", "failed", "waiting_started", "status" for agent runtime)

#### 2. Command Subjects
Used for messages that instruct components to perform actions.

Pattern: `compozy.<correlation_id>.<entity>.commands.<identifier>.<action>`

Where:
-   `<entity>`: Target entity type ("workflow", "task", "agent", "tool")
-   `<identifier>`: Target entity identifier (e.g., `workflow_id`, `workflow_exec_id`, `task_id`, `task_exec_id`, `agent_id`, `tool_id`)
    *Note: The specific identifier depends on the command's target.*
-   `<action>`: Action to perform (e.g., "execute", "cancel", "resume", "trigger")

---

### Subject Glossary

This section provides a quick reference to NATS subjects.

##### Workflow Subjects

**State Events**
*   `WorkflowExecutionStarted`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.started`
*   `WorkflowExecutionPaused`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.paused`
*   `WorkflowExecutionResumed`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.resumed`
*   `WorkflowExecutionSuccess`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.success`
*   `WorkflowExecutionFailed`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.failed`
*   `WorkflowExecutionCancelled`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.cancelled`
*   `WorkflowExecutionTimedOut`: `compozy.<correlation_id>.workflow.events.<workflow_exec_id>.timed_out` (Overall timeout)

**Commands**
*   `WorkflowExecute`: `compozy.<correlation_id>.workflow.commands.<workflow_id>.execute`
*   `WorkflowPause`: `compozy.<correlation_id>.workflow.commands.<workflow_exec_id>.pause`
*   `WorkflowResume`: `compozy.<correlation_id>.workflow.commands.<workflow_exec_id>.resume`
*   `WorkflowCancel`: `compozy.<correlation_id>.workflow.commands.<workflow_exec_id>.cancel`

##### Task Subjects

**State Events**
*   `TaskScheduled`: `compozy.<correlation_id>.task.events.<task_exec_id>.scheduled`
*   `TaskExecutionStarted`: `compozy.<correlation_id>.task.events.<task_exec_id>.started`
*   `TaskWaitingStarted`: `compozy.<correlation_id>.task.events.<task_exec_id>.waiting_started`
*   `TaskWaitingEnd`: `compozy.<correlation_id>.task.events.<task_exec_id>.waiting_ended`
*   `TaskWaitingTimedOut`: `compozy.<correlation_id>.task.events.<task_exec_id>.waiting_timed_out`
*   `TaskExecutionSuccess`: `compozy.<correlation_id>.task.events.<task_exec_id>.success`
*   `TaskExecutionFailed`: `compozy.<correlation_id>.task.events.<task_exec_id>.failed`
*   `TaskRetryScheduled`: `compozy.<correlation_id>.task.events.<original_task_exec_id>.retry_scheduled`

**Commands**
*   `TaskTrigger`: `compozy.<correlation_id>.task.commands.<task_id>.trigger`
*   `TaskExecute`: `compozy.<correlation_id>.task.commands.<task_id>.execute`
*   `TaskResume`: `compozy.<correlation_id>.task.commands.<task_exec_id>.resume`

##### Agent Subjects

**State Events**
*   `AgentExecutionStarted`: `compozy.<correlation_id>.agent.events.<agent_exec_id>.started`
*   `AgentExecutionSuccess`: `compozy.<correlation_id>.agent.events.<agent_exec_id>.success`
*   `AgentExecutionFailed`: `compozy.<correlation_id>.agent.events.<agent_exec_id>.failed`
*   `AgentDispatchFailed`: `compozy.<correlation_id>.agent.events.<agent_exec_id>.dispatch_failed`
*   `AgentRuntimeStatus`: `compozy.<correlation_id>.agent.events.<runtime_id>.status`

**Commands**
*   `TriggerAgent`: `compozy.<correlation_id>.agent.commands.<agent_id>.trigger`

##### Tool Subjects

**State Events**
*   `ToolExecutionStarted`: `compozy.<correlation_id>.tool.events.<tool_exec_id>.started`
*   `ToolExecutionSuccess`: `compozy.<correlation_id>.tool.events.<tool_exec_id>.success`
*   `ToolExecutionFailed`: `compozy.<correlation_id>.tool.events.<tool_exec_id>.failed`

**Commands**
*   `ToolExecute`: `compozy.<correlation_id>.tool.commands.<tool_id>.execute`