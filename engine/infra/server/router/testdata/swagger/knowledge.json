{
  "paths": {
    "/knowledge-bases": {
      "get": {
        "consumes": [
          "application/json"
        ],
        "description": "List knowledge bases with cursor-based pagination.",
        "parameters": [
          {
            "description": "Project override",
            "example": "\"demo\"",
            "in": "query",
            "name": "project",
            "type": "string"
          },
          {
            "description": "Page size (max 500)",
            "example": 50,
            "in": "query",
            "name": "limit",
            "type": "integer"
          },
          {
            "description": "Opaque pagination cursor",
            "in": "query",
            "name": "cursor",
            "type": "string"
          }
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Knowledge bases retrieved\" example({\"status\":200,\"message\":\"knowledge bases retrieved\",\"data\":{\"knowledge_bases\":[{\"id\":\"support\",\"embedder\":\"default-embedder\",\"vector_db\":\"default-vector\"}],\"page\":{\"limit\":1,\"next_cursor\":\"eyJpZCI6ICJiIn0=\",\"prev_cursor\":\"\"}},\"error\":null})",
            "headers": {
              "Link": {
                "description": "RFC 8288 pagination links for next/prev",
                "type": "string"
              }
            },
            "schema": {
              "allOf": [
                {
                  "$ref": "#/definitions/router.Response"
                },
                {
                  "properties": {
                    "data": {
                      "$ref": "#/definitions/knowledgerouter.KnowledgeBaseListResponse"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "400": {
            "description": "Invalid cursor parameter",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "500": {
            "description": "Internal server error",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          }
        },
        "summary": "List knowledge bases",
        "tags": [
          "knowledge"
        ]
      }
    },
    "/knowledge-bases/{kb_id}": {
      "delete": {
        "description": "Delete a knowledge base and remove persisted vectors.",
        "parameters": [
          {
            "description": "Knowledge base ID",
            "example": "\"support-docs\"",
            "in": "path",
            "name": "kb_id",
            "required": true,
            "type": "string"
          },
          {
            "description": "Project override",
            "example": "\"demo\"",
            "in": "query",
            "name": "project",
            "type": "string"
          },
          {
            "description": "Strong ETag for optimistic concurrency",
            "example": "\"\\\"etag123\\\"\"",
            "in": "header",
            "name": "If-Match",
            "type": "string"
          }
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "204": {
            "description": "No Content",
            "schema": {
              "type": "string"
            }
          },
          "404": {
            "description": "Knowledge base not found",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "409": {
            "description": "Knowledge base referenced",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "500": {
            "description": "Internal server error",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          }
        },
        "summary": "Delete knowledge base",
        "tags": [
          "knowledge"
        ]
      },
      "get": {
        "consumes": [
          "application/json"
        ],
        "description": "Retrieve a knowledge base by ID.",
        "parameters": [
          {
            "description": "Knowledge base ID",
            "example": "\"support-docs\"",
            "in": "path",
            "name": "kb_id",
            "required": true,
            "type": "string"
          },
          {
            "description": "Project override",
            "example": "\"demo\"",
            "in": "query",
            "name": "project",
            "type": "string"
          }
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Knowledge base retrieved\" example({\"status\":200,\"message\":\"knowledge base retrieved\",\"data\":{\"knowledge_base\":{\"id\":\"support\",\"embedder\":\"default-embedder\",\"vector_db\":\"default-vector\",\"_etag\":\"etag-value\"}},\"error\":null})",
            "headers": {
              "ETag": {
                "description": "Strong entity tag for caching",
                "type": "string"
              }
            },
            "schema": {
              "allOf": [
                {
                  "$ref": "#/definitions/router.Response"
                },
                {
                  "properties": {
                    "data": {
                      "$ref": "#/definitions/knowledgerouter.KnowledgeBaseResponse"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "400": {
            "description": "Invalid input",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "404": {
            "description": "Knowledge base not found",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "500": {
            "description": "Internal server error",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          }
        },
        "summary": "Get knowledge base",
        "tags": [
          "knowledge"
        ]
      },
      "put": {
        "consumes": [
          "application/json"
        ],
        "description": "Create a knowledge base when absent or update an existing one using strong ETag concurrency.",
        "parameters": [
          {
            "description": "Knowledge base ID",
            "example": "\"support-docs\"",
            "in": "path",
            "name": "kb_id",
            "required": true,
            "type": "string"
          },
          {
            "description": "Project override",
            "example": "\"demo\"",
            "in": "query",
            "name": "project",
            "type": "string"
          },
          {
            "description": "Strong ETag for optimistic concurrency",
            "example": "\"\\\"etag123\\\"\"",
            "in": "header",
            "name": "If-Match",
            "type": "string"
          },
          {
            "description": "Knowledge base definition",
            "in": "body",
            "name": "payload",
            "required": true,
            "schema": {
              "additionalProperties": true,
              "type": "object"
            }
          }
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Knowledge base updated\" example({\"status\":200,\"message\":\"knowledge base updated\",\"data\":{\"knowledge_base\":{\"id\":\"support\",\"embedder\":\"default-embedder\",\"vector_db\":\"default-vector\",\"description\":\"Support knowledge base\",\"_etag\":\"etag-value\"}},\"error\":null})",
            "headers": {
              "ETag": {
                "description": "Strong entity tag",
                "type": "string"
              }
            },
            "schema": {
              "allOf": [
                {
                  "$ref": "#/definitions/router.Response"
                },
                {
                  "properties": {
                    "data": {
                      "$ref": "#/definitions/knowledgerouter.KnowledgeBaseResponse"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "201": {
            "description": "Knowledge base created\" example({\"status\":201,\"message\":\"knowledge base created\",\"data\":{\"knowledge_base\":{\"id\":\"support\",\"embedder\":\"default-embedder\",\"vector_db\":\"default-vector\",\"description\":\"Support knowledge base\",\"_etag\":\"etag-value\"}},\"error\":null})",
            "headers": {
              "Location": {
                "description": "Relative URL for the knowledge base",
                "type": "string"
              }
            },
            "schema": {
              "allOf": [
                {
                  "$ref": "#/definitions/router.Response"
                },
                {
                  "properties": {
                    "data": {
                      "$ref": "#/definitions/knowledgerouter.KnowledgeBaseResponse"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "400": {
            "description": "Invalid request body",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "404": {
            "description": "Knowledge base not found",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "412": {
            "description": "ETag mismatch",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "500": {
            "description": "Internal server error",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          }
        },
        "summary": "Create or update knowledge base",
        "tags": [
          "knowledge"
        ]
      }
    },
    "/knowledge-bases/{kb_id}/ingest": {
      "post": {
        "consumes": [
          "application/json"
        ],
        "description": "Trigger ingestion for configured sources using the requested strategy.",
        "parameters": [
          {
            "description": "Knowledge base ID",
            "example": "\"support-docs\"",
            "in": "path",
            "name": "kb_id",
            "required": true,
            "type": "string"
          },
          {
            "description": "Project override",
            "example": "\"demo\"",
            "in": "query",
            "name": "project",
            "type": "string"
          },
          {
            "description": "Ingestion request",
            "in": "body",
            "name": "payload",
            "required": true,
            "schema": {
              "$ref": "#/definitions/knowledgerouter.KnowledgeIngestRequest"
            }
          }
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Ingestion summary\" example({\"status\":200,\"message\":\"knowledge ingestion completed\",\"data\":{\"knowledge_base_id\":\"support\",\"binding_id\":\"binding-123\",\"documents\":2,\"chunks\":16,\"persisted\":16},\"error\":null})",
            "schema": {
              "allOf": [
                {
                  "$ref": "#/definitions/router.Response"
                },
                {
                  "properties": {
                    "data": {
                      "$ref": "#/definitions/knowledgerouter.KnowledgeIngestResponse"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "400": {
            "description": "Invalid request",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "404": {
            "description": "Knowledge base not found",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "500": {
            "description": "Internal server error",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          }
        },
        "summary": "Ingest knowledge base",
        "tags": [
          "knowledge"
        ]
      }
    },
    "/knowledge-bases/{kb_id}/query": {
      "post": {
        "consumes": [
          "application/json"
        ],
        "description": "Execute a dense similarity query against a knowledge base.",
        "parameters": [
          {
            "description": "Knowledge base ID",
            "example": "\"support-docs\"",
            "in": "path",
            "name": "kb_id",
            "required": true,
            "type": "string"
          },
          {
            "description": "Project override",
            "example": "\"demo\"",
            "in": "query",
            "name": "project",
            "type": "string"
          },
          {
            "description": "Query request",
            "in": "body",
            "name": "payload",
            "required": true,
            "schema": {
              "$ref": "#/definitions/knowledgerouter.KnowledgeQueryRequest"
            }
          }
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Query matches\" example({\"status\":200,\"message\":\"knowledge query completed\",\"data\":{\"matches\":[{\"binding_id\":\"binding-123\",\"content\":\"Reset your password from the account settings page.\",\"score\":0.83,\"token_estimate\":120}]},\"error\":null})",
            "schema": {
              "allOf": [
                {
                  "$ref": "#/definitions/router.Response"
                },
                {
                  "properties": {
                    "data": {
                      "$ref": "#/definitions/knowledgerouter.KnowledgeQueryResponse"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "400": {
            "description": "Invalid request",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "404": {
            "description": "Knowledge base not found",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          },
          "500": {
            "description": "Internal server error",
            "schema": {
              "$ref": "#/definitions/core.ProblemDocument"
            }
          }
        },
        "summary": "Query knowledge base",
        "tags": [
          "knowledge"
        ]
      }
    }
  },
  "tags": []
}
