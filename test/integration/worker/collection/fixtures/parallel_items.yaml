name: collection-parallel-items

workflow:
  id: test-collection-parallel
  version: "1.0.0"
  tasks:
    - id: process-items-parallel
      type: collection
      mode: parallel
      items: "{{ .workflow.input.test_items }}"
      task:
        id: "process-items-parallel-item-{{ .index }}"
        type: basic
        action: process_parallel_item
        with:
          task_id: "{{ .item.id }}"
          priority: "{{ .item.priority }}"
          timeout_ms: "{{ .item.timeout }}"
          start_time: "2024-01-01T00:00:00Z"

input:
  test_items:
    - id: "task-1"
      priority: "high"
      timeout: 1000
    - id: "task-2"
      priority: "medium"
      timeout: 2000

expected:
  workflow_state:
    status: "SUCCESS"
    total_tasks: 3 # 1 parent + 2 children
    completed_tasks: 3
  task_states:
    - name: process-items-parallel
      status: "SUCCESS"
    - name: process-items-parallel-item-0
      status: "SUCCESS"
      parent: process-items-parallel
    - name: process-items-parallel-item-1
      status: "SUCCESS"
      parent: process-items-parallel
