name: basic-task-with-next

workflow:
  id: test-next-workflow
  version: "1.0.0"
  tasks:
    - id: first-task
      type: basic
      action: test-action
      with:
        step: 1
      outputs:
        step_completed: 1
      on_success:
        next: second-task
    - id: second-task
      type: basic
      action: test-action
      with:
        step: 2
        previous_step: "{{ .tasks.first-task.output.step_completed }}"
      outputs:
        step_completed: 2
        received_previous: "{{ .with.previous_step }}"
    - id: third-task
      type: basic
      action: test-action
      with:
        step: 3
      outputs:
        step_completed: 3

expected:
  workflow_state:
    status: "SUCCESS"
    total_tasks: 3
    completed_tasks: 3
  task_states:
    - name: first-task
      status: "SUCCESS"
      output:
        step_completed: 1
    - name: second-task
      status: "SUCCESS"
      output:
        step_completed: 2
        received_previous: "1"
    - name: third-task
      status: "SUCCESS"
      output:
        step_completed: 3
